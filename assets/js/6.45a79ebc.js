(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{275:function(t,s,a){t.exports=a.p+"assets/img/require.63088a5b.png"},276:function(t,s,a){t.exports=a.p+"assets/img/nodeability.1343d4a4.png"},277:function(t,s,a){t.exports=a.p+"assets/img/node-framework.ab79f1b5.png"},278:function(t,s,a){t.exports=a.p+"assets/img/eventEmitter.4d0be828.png"},279:function(t,s,a){t.exports=a.p+"assets/img/moduleme.6e0827b0.png"},280:function(t,s,a){t.exports=a.p+"assets/img/modulepriority.603de0d7.png"},281:function(t,s,a){t.exports=a.p+"assets/img/moduleLocation.9c7a1713.png"},282:function(t,s,a){t.exports=a.p+"assets/img/networkmodel.6dfd0c0e.png"},283:function(t,s,a){t.exports=a.p+"assets/img/browserEventloop.fddfb26d.png"},284:function(t,s,a){t.exports=a.p+"assets/img/nodeventloop.e925202b.png"},285:function(t,s,a){t.exports=a.p+"assets/img/baseFramework.9cbb930f.png"},286:function(t,s,a){t.exports=a.p+"assets/img/routerMiddle.c7fe5f02.png"},287:function(t,s,a){t.exports=a.p+"assets/img/writeMiddle.fb581c4f.png"},288:function(t,s,a){t.exports=a.p+"assets/img/routingMe.536cb95f.png"},289:function(t,s,a){t.exports=a.p+"assets/img/preform.0709148c.png"},290:function(t,s,a){t.exports=a.p+"assets/img/requirement.3042761f.png"},291:function(t,s,a){t.exports=a.p+"assets/img/fundesign.f9767f3b.png"},292:function(t,s,a){t.exports=a.p+"assets/img/httpres.b613a7c1.png"},414:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"_1-1-nodejs-简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-nodejs-简介"}},[t._v("#")]),t._v(" 1.1 Nodejs 简介")]),t._v(" "),n("h3",{attrs:{id:"_1-1-1-安装node"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-安装node"}},[t._v("#")]),t._v(" 1.1.1 安装node")]),t._v(" "),n("h4",{attrs:{id:"mac"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mac"}},[t._v("#")]),t._v(" Mac")]),t._v(" "),n("ol",[n("li",[t._v("MacOS-installer.pkg 官方提供的安装包")]),t._v(" "),n("li",[t._v("HomeBrew 命令安装到全局")]),t._v(" "),n("li",[t._v("nvm 管理版本，方便切换（推荐）")])]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装nvm")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.1/install.sh "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nvm安装node")]),t._v("\nnvm "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --lts\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果显示没有发现这个命令，就编辑.bash_profile")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" .bash_profile\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把以下复制进去，wq保存退出，如果不了解vim编辑，可以谷歌")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NVM_DIR")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$HOME")]),t._v('/.nvm"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" -s "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NVM_DIR")]),t._v('/nvm.sh"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(". "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NVM_DIR")]),t._v('/nvm.sh"')]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This loads nvm")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" -s "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NVM_DIR")]),t._v('/bash_completion"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v(". "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NVM_DIR")]),t._v('/bash_completion"')]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# This loads nvm bash_completion")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 然后 source 一下 .bash_profile")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("source")]),t._v(" .bash_profile\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br")])]),n("h4",{attrs:{id:"winndow"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#winndow"}},[t._v("#")]),t._v(" winndow")]),t._v(" "),n("ol",[n("li",[t._v("Windows-installer.msi 官方安装包，快速开始，推荐使用")]),t._v(" "),n("li",[t._v("nvm-windows windows版本的nvm，社区维护不稳定")]),t._v(" "),n("li",[t._v("Cmder 集成命令行工具 （推荐）")]),t._v(" "),n("li",[t._v("WSL Window提供的内置Linux运行环境，配合VSCode （推荐）")]),t._v(" "),n("li",[t._v("Windows Terminal")])]),t._v(" "),n("h3",{attrs:{id:"_1-1-2-node版本选择"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-node版本选择"}},[t._v("#")]),t._v(" 1.1.2 node版本选择")]),t._v(" "),n("p",[t._v("LTS是稳定版本，Current最新版本")]),t._v(" "),n("h3",{attrs:{id:"_1-1-3-nodejs模块机制及包管理器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-3-nodejs模块机制及包管理器"}},[t._v("#")]),t._v(" 1.1.3 Nodejs模块机制及包管理器")]),t._v(" "),n("h4",{attrs:{id:"nodejs-模块机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs-模块机制"}},[t._v("#")]),t._v(" nodejs 模块机制")]),t._v(" "),n("ul",[n("li",[t._v("Node应用由模块组成，采用CJS/ESM模块规范来组织")]),t._v(" "),n("li",[t._v("每个文件就是模块，有自己的作用域")]),t._v(" "),n("li",[t._v("每个文件里面定义的变量、函数、类都是私有的，对其他文件不可见")]),t._v(" "),n("li",[t._v("在Node中，模块的加载是运行时同步加载的")]),t._v(" "),n("li",[t._v("模块可以多次加载，但是只会在第一次加载时运行一次，然后运行结果就被缓存了")])]),t._v(" "),n("h4",{attrs:{id:"模块加载机制-require-export"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块加载机制-require-export"}},[t._v("#")]),t._v(" 模块加载机制 require/export")]),t._v(" "),n("p",[n("img",{attrs:{src:a(275),alt:""}})]),t._v(" "),n("p",[t._v("在一个文件"),n("code",[t._v("require")]),t._v("一个包的时候（const xx =require('xx')），node会看require里的路径类型，")]),t._v(" "),n("ol",[n("li",[t._v("如果是一个内置模块，就直接返回这个内置模块，例如：path、fs等。")]),t._v(" "),n("li",[t._v("如果是相对路径或者绝对路径，node会先把相对路径转换成绝对路径，会在当前路径下查找是否有xx文件，如果存在就返回，如果没找到会把xx当作目录，在这个目录下查找index文件，找到就返回，没找到就Can't find。")]),t._v(" "),n("li",[t._v("如果没有路径就是我们的第三方模块，根据所在的父模块确定安装目录，在目录中查找入口文件，这个入口文件就是index.js或main.js,bin下的文件，这个文件由package.json来指定。")])]),t._v(" "),n("p",[t._v("在node处理模块加载的时候，还有缓存的概念，就是说缓存中存在了，就直接返回；内置模块直接加载；根据找到文件创建新的模块并缓存。")]),t._v(" "),n("h4",{attrs:{id:"nodejs包管理器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs包管理器"}},[t._v("#")]),t._v(" nodejs包管理器")]),t._v(" "),n("ul",[n("li",[t._v("npm 代指Node的模块生态，又代指模块安装CLI工具")]),t._v(" "),n("li",[t._v("通过package.json来描述项目的基本配置信息和依赖，组成树状结构")]),t._v(" "),n("li",[t._v("使用nvm管理node版本，使用nrm管理npm源，使用npx执行命令")]),t._v(" "),n("li",[t._v("使用scripts组织工程化脚本入口")])]),t._v(" "),n("h3",{attrs:{id:"_1-1-4-nodejs的能力"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-4-nodejs的能力"}},[t._v("#")]),t._v(" 1.1.4 Nodejs的能力")]),t._v(" "),n("p",[n("img",{attrs:{src:a(276),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"_1-2-nodejs提供的原生api能力-上"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-nodejs提供的原生api能力-上"}},[t._v("#")]),t._v(" 1.2 Nodejs提供的原生API能力（上）")]),t._v(" "),n("h4",{attrs:{id:"node架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node架构"}},[t._v("#")]),t._v(" node架构")]),t._v(" "),n("p",[n("img",{attrs:{src:a(277),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_1-2-1-了解nodejs提供的数据类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-了解nodejs提供的数据类型"}},[t._v("#")]),t._v(" 1.2.1 了解Nodejs提供的数据类型")]),t._v(" "),n("h4",{attrs:{id:"_1-nodejs数据类型-buffer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-nodejs数据类型-buffer"}},[t._v("#")]),t._v(" 1. Nodejs数据类型-Buffer")]),t._v(" "),n("ul",[n("li",[t._v("流式数据（非一次性加载完成的数据）由于产生和使用不一定同速，所以需要缓存")]),t._v(" "),n("li",[t._v("存储需要临时占用大量内存的数据，内存中开辟的一片区域，用于存放二进制数据")]),t._v(" "),n("li",[t._v("流的生产者与消费者之间的速度通常是不一致的，因此需要buffer来暂存一些数据")]),t._v(" "),n("li",[t._v("buffer大小通过highWaterMark参数指定，默认情况下是16kb")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(70),alt:""}})]),t._v(" "),n("p",[t._v("🍅 创建buffer")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("Buffer.from(buffer | array | string) 使用堆外内存新增Buffer")])]),t._v(" "),n("li",[n("p",[t._v("Buffer.from(arrayBuffer) 浅拷贝arrayBuffer，共享内存")])]),t._v(" "),n("li",[n("p",[t._v("Buffer.alloc(size) 分配一个指定大小的Buffer,默认值0，使用UTF-8编码")])]),t._v(" "),n("li",[n("p",[t._v("Buffer.allocUnsafe(size) 分配一个初始化的Buffer")])]),t._v(" "),n("li",[n("p",[t._v("流式数据会自动创建Buffer，手动创建Buffer需谨慎")])])]),t._v(" "),n("p",[t._v("🍅 创建Buffer-坑")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("预分配一个内部的大小为Buffer.poolSize(8k)的Buffer实例，作为快速分配的内存池")])]),t._v(" "),n("li",[n("p",[t._v("如果allocUnsafe/from(array)的size小于4k，则从预分配的池子中分配")])]),t._v(" "),n("li",[n("p",[t._v("绕开V8回收机制，使用专用回收机制，提高性能和内存使用效率")])]),t._v(" "),n("li",[n("p",[t._v("但这种玩法会导致未初始化的数据块投入使用，造成数据泄露风险")])])]),t._v(" "),n("p",[t._v("🍅  使用Buffer")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("转换格式")]),t._v(" "),n("ul",[n("li",[t._v("字符串：编码Buffer.from(string),解码buf.toString()")]),t._v(" "),n("li",[t._v("JSON:buf.JSON()")])])]),t._v(" "),n("li",[n("p",[t._v("剪裁和拼接")]),t._v(" "),n("ul",[n("li",[t._v("剪裁：Buffer.slice()表现与Array.slice()不同，返回Buffer与原buf共享内存")]),t._v(" "),n("li",[t._v("拼接：buf.copy/buf.concat 返回新的Buffer")])])]),t._v(" "),n("li",[n("p",[t._v("比较和遍历索引")]),t._v(" "),n("ul",[n("li",[t._v("判断相等：buf1.equals(buf2) 比较的是二进制的值")]),t._v(" "),n("li",[t._v("索引：使用buf[index]形式进行索引，for...of/indexOf/includes等Array方法也可以使用")])])])]),t._v(" "),n("h4",{attrs:{id:"_2-nodejs数据类型-stream"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-nodejs数据类型-stream"}},[t._v("#")]),t._v(" 2. Nodejs数据类型-Stream")]),t._v(" "),n("ul",[n("li",[t._v("Stream 模块提供的是抽象接口，有很多模块实现了这个接口")]),t._v(" "),n("li",[t._v("Stream 就是解决生产者和消费者问题的一种方式，解决异步IO问题")]),t._v(" "),n("li",[t._v("Stream 模块对于流的使用者而言无需关心 readableSrc.pipe(writableDest)")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(70),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"_3-nodejs数据类型-event-eventemitter"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-nodejs数据类型-event-eventemitter"}},[t._v("#")]),t._v(" 3. Nodejs数据类型-event/EventEmitter")]),t._v(" "),n("p",[n("img",{attrs:{src:a(278),alt:""}})]),t._v(" "),n("p",[t._v("event只提供了EventEmitter一个对象，相当于事件触发，会触发很多事件，触发事件会进入EventLoop，一旦触发会被Event handlers捕获。\nEventEmitter的核心就是事件触发的Emitter，事件监听的on功能进行封装，一个简单的EventEmitter绑定一个监听器，然后去监听事件。")]),t._v(" "),n("h4",{attrs:{id:"_4-nodejs数据类型-error"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-nodejs数据类型-error"}},[t._v("#")]),t._v(" 4. Nodejs数据类型-Error")]),t._v(" "),n("p",[t._v("🍅 错误类型")]),t._v(" "),n("ul",[n("li",[t._v("标准的javascript错误，比如：SyntaxError/ReferenceError")]),t._v(" "),n("li",[t._v("底层操作触发的系统错误，比如：文件读写")]),t._v(" "),n("li",[t._v("用户自定义错误")]),t._v(" "),n("li",[t._v("异常逻辑触发的AssertionError，通常来自assert模块")])]),t._v(" "),n("p",[t._v("🍅 错误冒泡和捕获")]),t._v(" "),n("ul",[n("li",[t._v("所有通过Node.j或javaScript运行时抛出的异常都是Error实例")]),t._v(" "),n("li",[t._v("大多数的异步方法接受一个callback函数，该函数会接受一个Error对象传入作为第一个参数")])]),t._v(" "),n("h4",{attrs:{id:"_5-nodejs数据类型-url"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-nodejs数据类型-url"}},[t._v("#")]),t._v(" 5. Nodejs数据类型-URL")]),t._v(" "),n("ul",[n("li",[t._v("弃用urlObjects，该用WHATWG URL")]),t._v(" "),n("li",[t._v("使用URLSearchParams操作参数")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  案例：截取params1和params2=2  https://hejialianghe.github.io?params1=1&params2=2")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.截取url上的参数（老方法）")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" _query"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// _query 拿到的是params1=1&params2=2，url.parse(req.url).pathname，可以拿到https://hejialianghe.github.io?")]),t._v("\n  Querystring"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'params1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.使用URLSearchParams操作参数")]),t._v("\n  Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fromEntries")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("URLSearchParams")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// {params1:1,params2:2} ")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br")])]),n("h4",{attrs:{id:"_6-nodejs数据类型-global"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-nodejs数据类型-global"}},[t._v("#")]),t._v(" 6. Nodejs数据类型-global")]),t._v(" "),n("ul",[n("li",[t._v("看上去像是全局变量的存在，实际上仅存在于模块的作用域中")])]),t._v(" "),n("p",[n("code",[t._v("__dirname、__filename、exports、module、require()")])]),t._v(" "),n("ul",[n("li",[t._v("从javaScript继承而来的全局变量")])]),t._v(" "),n("p",[n("code",[t._v("console、timer全家桶、global（容器）")])]),t._v(" "),n("ul",[n("li",[t._v("Nodejs特有的全局变量")])]),t._v(" "),n("p",[n("code",[t._v("Buffer、process、URL、WepASSembly")])]),t._v(" "),n("p",[t._v("这些可以不用太深入，至少有这个概念，node架构最底层的数据类型，其实有这些数据类型，在上层去实现复杂的业务逻辑的时候；就可以调用这些数据类型，这是node帮我们封装好的；不用在再去造轮子。")]),t._v(" "),n("h3",{attrs:{id:"_1-2-2-nodejs-工具库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-nodejs-工具库"}},[t._v("#")]),t._v(" 1.2.2 Nodejs 工具库")]),t._v(" "),n("h4",{attrs:{id:"nodejs工具库-util"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs工具库-util"}},[t._v("#")]),t._v(" Nodejs工具库-util")]),t._v(" "),n("p",[t._v("本是内置模块开发时的公共工具集，现在开放给开发者使用")]),t._v(" "),n("p",[t._v("🍅 风格转换")]),t._v(" "),n("ul",[n("li",[t._v("promisify<=>callbackify、TextEncoder<=>TextDecoder")])]),t._v(" "),n("p",[t._v("🍅 调试工具")]),t._v(" "),n("ul",[n("li",[t._v("debuglog、inspect、format、getSystemErrorName")])]),t._v(" "),n("p",[t._v("🍅 类型判断")]),t._v(" "),n("ul",[n("li",[t._v("types.isDate(value)")])]),t._v(" "),n("h4",{attrs:{id:"nodejs断言等价-assert"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs断言等价-assert"}},[t._v("#")]),t._v(" Nodejs断言等价-assert")]),t._v(" "),n("p",[t._v("内置断言库，需要配合测试框架使用，主动抛出AssertionError错误")]),t._v(" "),n("p",[t._v("🍅 断言真假")]),t._v(" "),n("ul",[n("li",[t._v("assert(value,msg),match(string,reg)")])]),t._v(" "),n("p",[t._v("🍅 断言等价")]),t._v(" "),n("ul",[n("li",[t._v("strictEqual/deepStrictEqual以及相反操作equal/deepEqual弃用")])]),t._v(" "),n("p",[t._v("🍅 断言成功失败")]),t._v(" "),n("ul",[n("li",[t._v("fail/throws doesNotThrow/ifError/rejects")])]),t._v(" "),n("h4",{attrs:{id:"nodejs工具库-querystring"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs工具库-querystring"}},[t._v("#")]),t._v(" Nodejs工具库-querystring")]),t._v(" "),n("p",[t._v("官方提供的解析和格式化URL查询字符串的实用工具")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("查询字符串转键值对 querystring.parse(str[,sep[eq[,options]]])")])]),t._v(" "),n("li",[n("p",[t._v("键值对转查询字符串 querystring.stringify(obj)")])])]),t._v(" "),n("h3",{attrs:{id:"_1-2-3-nodejs的文件操作能力"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-nodejs的文件操作能力"}},[t._v("#")]),t._v(" 1.2.3 Nodejs的文件操作能力")]),t._v(" "),n("h4",{attrs:{id:"nodejs的文件操作能力-os"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs的文件操作能力-os"}},[t._v("#")]),t._v(" Nodejs的文件操作能力-os")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("os模块提供了与操作系统相关的实用方法和属性")])]),t._v(" "),n("li",[n("p",[t._v("通过兼容的方式调用不同平台的底层命令，形成系统快照")]),t._v(" "),n("p",[n("code",[t._v("cpus、platform、type、uptime、userInfo")])])]),t._v(" "),n("li",[n("p",[t._v("定义操作系统级别的枚举常量")])])]),t._v(" "),n("p",[n("code",[t._v("信号常量SIG*、错误常量E*、windows特有WSA*、优先级PRIORITY_*")])]),t._v(" "),n("h4",{attrs:{id:"nodejs的文件操作能力-fs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs的文件操作能力-fs"}},[t._v("#")]),t._v(" Nodejs的文件操作能力-fs")]),t._v(" "),n("ul",[n("li",[t._v("fs模块模拟Linux环境，提供了用于与文件系统进行交互的API")]),t._v(" "),n("li",[t._v("所有的文件系统操作都具有同步和异步的形式")]),t._v(" "),n("li",[t._v("URI作为特殊的文件也可以被fs模块实用")]),t._v(" "),n("li",[t._v("操作文件夹\n"),n("ul",[n("li",[t._v("mkdir/rmdir")])])]),t._v(" "),n("li",[t._v("操作文件\n"),n("ul",[n("li",[t._v("chmod/open/read/write")])])])]),t._v(" "),n("h3",{attrs:{id:"_1-2-4-nodejs的文件操作能力"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4-nodejs的文件操作能力"}},[t._v("#")]),t._v(" 1.2.4 Nodejs的文件操作能力")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/learn/Server-side/Express_Nodejs",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN 中提供的 Nodejs 课程"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs中文文档站点"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/5d4fb52c518825219c281bd1",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs安装详解"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/sindresorhus/awesome-nodejs",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs优秀项目集合"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"_1-3-nodejs提供的原生api能力-下"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-nodejs提供的原生api能力-下"}},[t._v("#")]),t._v(" 1.3 Nodejs提供的原生API能力（下）")]),t._v(" "),n("h3",{attrs:{id:"_1-3-1-nodejs的模块机制及原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-nodejs的模块机制及原理"}},[t._v("#")]),t._v(" 1.3.1 Nodejs的模块机制及原理")]),t._v(" "),n("h4",{attrs:{id:"nodejs的模块机制-commonjs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs的模块机制-commonjs"}},[t._v("#")]),t._v(" Nodejs的模块机制-CommonJS")]),t._v(" "),n("ul",[n("li",[t._v("模块引用")])]),t._v(" "),n("p",[t._v("通过require（module）来引入module")]),t._v(" "),n("ul",[n("li",[t._v("模块定义")])]),t._v(" "),n("p",[t._v("通过挂载在module.exports对象上实现定义")]),t._v(" "),n("ul",[n("li",[t._v("模块标识")])]),t._v(" "),n("p",[t._v("通过路径标识引入的是哪个模块")]),t._v(" "),n("p",[t._v("在node引入一个模块会经历下面这4个阶段")]),t._v(" "),n("p",[n("img",{attrs:{src:a(279),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"路径分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路径分析"}},[t._v("#")]),t._v(" 路径分析")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("内置模块")])]),t._v(" "),n("li",[n("p",[t._v("在Node进程开始的时候就预加载了")])]),t._v(" "),n("li",[n("p",[t._v("加载的是二进制文件，需要定位和编译")])]),t._v(" "),n("li",[n("p",[t._v("文件模块")])]),t._v(" "),n("li",[n("p",[t._v("通过NPM安装的第三方模块")])]),t._v(" "),n("li",[n("p",[t._v("本地模块")])]),t._v(" "),n("li",[n("p",[t._v("模块内容")])]),t._v(" "),n("li",[n("p",[t._v("函数、对象或者属性，如函数、数组甚至任意类型的JS对象")])])]),t._v(" "),n("h4",{attrs:{id:"模块加载优先级"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块加载优先级"}},[t._v("#")]),t._v(" 模块加载优先级")]),t._v(" "),n("p",[n("img",{attrs:{src:a(280),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"模块文件定位"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块文件定位"}},[t._v("#")]),t._v(" 模块文件定位")]),t._v(" "),n("p",[n("img",{attrs:{src:a(281),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"编译模块执行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编译模块执行"}},[t._v("#")]),t._v(" 编译模块执行")]),t._v(" "),n("ul",[n("li",[n("p",[t._v(".js 文件：")]),t._v(" "),n("ul",[n("li",[t._v("通过fs模块同步读取后编译执行，未识别类型也会当作js处理")])])]),t._v(" "),n("li",[n("p",[t._v(".json 文件：")]),t._v(" "),n("ul",[n("li",[t._v("通过fs模块同步读取后，用JSON.parse()解析并返回结果")])])]),t._v(" "),n("li",[n("p",[t._v(".node 文件：")]),t._v(" "),n("ul",[n("li",[t._v("这是用C/C++写的扩展文件，通过process.dlopen()方法加载最后编译生成的")])])])]),t._v(" "),n("h4",{attrs:{id:"模块js文件的编译"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块js文件的编译"}},[t._v("#")]),t._v(" 模块js文件的编译")]),t._v(" "),n("ul",[n("li",[t._v("注入全局变量\n"),n("ul",[n("li",[t._v("以参数形式，注入module/exports/require方法")]),t._v(" "),n("li",[t._v("同时注入路径解析时得到的__filename/__dirname")])])]),t._v(" "),n("li",[t._v("构造上下文执行环境\n"),n("ul",[n("li",[t._v("闭包产生作用域，通过runlnThisContext()执行")]),t._v(" "),n("li",[t._v("将function对象挂载到exports对象上，并导出")])])])]),t._v(" "),n("h4",{attrs:{id:"加入缓存以及清除缓存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加入缓存以及清除缓存"}},[t._v("#")]),t._v(" 加入缓存以及清除缓存")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("核心模块")]),t._v(" "),n("ul",[n("li",[t._v("登记在NativeModeule._cache上")])])]),t._v(" "),n("li",[n("p",[t._v("文件模块")]),t._v(" "),n("ul",[n("li",[t._v("封装后的方法以字符串形式存储，等待调用")])])]),t._v(" "),n("li",[n("p",[t._v("清除缓存")]),t._v(" "),n("ul",[n("li",[t._v("通过delete require.catch[require.resolove(module)]")])])])]),t._v(" "),n("h4",{attrs:{id:"import-vs-require"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#import-vs-require"}},[t._v("#")]),t._v(" import vs require")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("import")]),t._v(" "),n("ul",[n("li",[t._v("ES6规范")]),t._v(" "),n("li",[t._v("静态加载模块")]),t._v(" "),n("li",[t._v("编译的时候执行代码")]),t._v(" "),n("li",[t._v("缓存执行结果")]),t._v(" "),n("li",[t._v("按需引入，节省内存")])])]),t._v(" "),n("li",[n("p",[t._v("require")]),t._v(" "),n("ul",[n("li",[t._v("commonJS规范")]),t._v(" "),n("li",[t._v("动态加载模块")]),t._v(" "),n("li",[t._v("调用的时候加载源码")]),t._v(" "),n("li",[t._v("加载全部代码")])]),t._v(" "),n("h3",{attrs:{id:"_1-3-2-nodejs的网络编程能力"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-nodejs的网络编程能力"}},[t._v("#")]),t._v(" 1.3.2 Nodejs的网络编程能力")]),t._v(" "),n("h4",{attrs:{id:"网络模型-osi-tcp-ip"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络模型-osi-tcp-ip"}},[t._v("#")]),t._v(" 网络模型 OSI & TCP/IP")])])]),t._v(" "),n("p",[n("img",{attrs:{src:a(282),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"soket"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#soket"}},[t._v("#")]),t._v(" Soket")]),t._v(" "),n("ul",[n("li",[t._v("实现底层通信，几乎所有的应用层都是通过socket进行通信")]),t._v(" "),n("li",[t._v("对TCP/IP协议进行封装，向应用层协议暴露接口调用")]),t._v(" "),n("li",[t._v("TCP/IP协议中，传输层存在两种通用协议：TCP、UDP")]),t._v(" "),n("li",[t._v("两种协议不同，因为不同参数的socket实现过程也不一样")])]),t._v(" "),n("h4",{attrs:{id:"nodejs网络基础模块-net-dgram"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs网络基础模块-net-dgram"}},[t._v("#")]),t._v(" Nodejs网络基础模块-net/dgram")]),t._v(" "),n("ul",[n("li",[t._v("net 模块是TCP/IP的Node实现，提供一些用于底层的网络通信的小工具")]),t._v(" "),n("li",[t._v("http.Server 继承自net.Server")]),t._v(" "),n("li",[t._v("http 客户端与http服务端的通信均依赖与socket（net.Socket）\n"),n("ul",[n("li",[t._v("net.Server: TCP server,内部通过socket来实现与客户端的通信")]),t._v(" "),n("li",[t._v("net.Socket: 本地socket与node版实现，它实现了全双工的stream接口")])])])]),t._v(" "),n("h4",{attrs:{id:"nodejs网络基础模块-net-socket"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs网络基础模块-net-socket"}},[t._v("#")]),t._v(" Nodejs网络基础模块-net.Socket")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("net.Socket 对象是TCP或UNIX Socket 的抽象")])]),t._v(" "),n("li",[n("p",[t._v("net.Socket 实例实现了一个双工流接口")])]),t._v(" "),n("li",[n("p",[t._v("API归纳")]),t._v(" "),n("ul",[n("li",[t._v("连接相关connect")]),t._v(" "),n("li",[t._v("数据读写 write")]),t._v(" "),n("li",[t._v("数据属性 bufferSize")]),t._v(" "),n("li",[t._v("地址相关 address")])])])]),t._v(" "),n("h4",{attrs:{id:"nodejs网络基础模块-http-https-http2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs网络基础模块-http-https-http2"}},[t._v("#")]),t._v(" Nodejs网络基础模块-http/https/http2")]),t._v(" "),n("ul",[n("li",[t._v("Http模块是Node的门脸，是编写Web Server最常见的模块")]),t._v(" "),n("li",[t._v("Server部分继承自net.Server,并对请求和响应数据进行封装")]),t._v(" "),n("li",[t._v("也提供了request/get的能力，允许向其他服务端发起HTTP请求")]),t._v(" "),n("li",[t._v("Node封装了HTTPS/HTTP2的实现，可以轻松创建类HTTP服务")])]),t._v(" "),n("h3",{attrs:{id:"_1-3-3-的进程管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-的进程管理"}},[t._v("#")]),t._v(" 1.3.3 的进程管理")]),t._v(" "),n("h4",{attrs:{id:"操作系统的进程和线层"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#操作系统的进程和线层"}},[t._v("#")]),t._v(" 操作系统的进程和线层")]),t._v(" "),n("ul",[n("li",[t._v("运行任务的程序叫做“进程”，一个进程只能执行一个任务")]),t._v(" "),n("li",[t._v("进程并发：以多进程形式，允许多个任务同时运行")]),t._v(" "),n("li",[t._v("线层并发：以多线程形式，允许单个任务分成不同的部分运行")]),t._v(" "),n("li",[t._v("操作系统提供协调机制，防止冲突，共享资源")]),t._v(" "),n("li",[t._v("javascript是单线层语言，所以多个任务只能排队运行")])]),t._v(" "),n("h4",{attrs:{id:"多进程vs多线程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多进程vs多线程"}},[t._v("#")]),t._v(" 多进程vs多线程")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[t._v("维度")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("多进程")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("多线程")]),t._v(" "),n("th",{staticStyle:{"text-align":"center"}},[t._v("比较")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("数据共享")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("数据共享复杂，需要用IPC；数据是分开的，同步简单")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("因为共享进程数据，数据共享简单，同步复杂")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("各有千秋")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("资源利用")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("占用内存，切换复杂，CPU利用率低")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("占用内存少，切换简单，cpu利用高")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("多线程更好")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("性能开销")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("创建销毁、切换复杂、速度慢")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("创建销毁、切换简单、速度很快")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("多线程更好")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("编码实践")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("编码简单、调试方便")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("编码、调试复杂")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("多进程更好")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("可靠性")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("进程独立运行，不会相互影响")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("线程呼吸共命运")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("多进程更好")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[t._v("分布式支持")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("可用于多机多核分布式，易于扩展")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("只能用于多核分布式")]),t._v(" "),n("td",{staticStyle:{"text-align":"center"}},[t._v("多进程更好")])])])]),t._v(" "),n("h4",{attrs:{id:"event-loop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-loop"}},[t._v("#")]),t._v(" Event Loop")]),t._v(" "),n("ul",[n("li",[t._v("javascript通过EventLoop的形式解决单线程任务调度问题")]),t._v(" "),n("li",[t._v("EventLoop是一个程序结构，用于等待和发送消息和事件")]),t._v(" "),n("li",[t._v("浏览器的Event loop和Node的Event loop是两个概念")])]),t._v(" "),n("h4",{attrs:{id:"浏览器的event-loop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的event-loop"}},[t._v("#")]),t._v(" 浏览器的Event Loop")]),t._v(" "),n("p",[n("img",{attrs:{src:a(283),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"nodejs-event-loop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs-event-loop"}},[t._v("#")]),t._v(" Nodejs-Event Loop")]),t._v(" "),n("p",[n("img",{attrs:{src:a(284),alt:""}})]),t._v(" "),n("p",[t._v("node采用v8作为js解析引擎，io处理方面用到了自己的LIBUV，LIBUV是跨平台的抽象层，封装了不同平台的底层特性，对外提供了统一的api；事件循环机制也是它里面实现的，所以v8引擎解析js脚本，解析后的代码调用nodeAPI；LIBUV库负责nodeAPI的执行，将不同的任务分配给不同的线程形成一个Eventloop，将不同的任务分配给不同的线程，以异步的形式将结果返回给v8，v8在将结果返回给用户；LIBUV引擎分为6个阶段，它会按照顺序反复执行，每当\n进入某个阶段的时候，都会从对应的回调队列中抽取函数去执行，当队列为空或回调函数达到系统设置的值的时候，就会进入下一个阶段")]),t._v(" "),n("h4",{attrs:{id:"nodejs进程-process"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs进程-process"}},[t._v("#")]),t._v(" Nodejs进程-process")]),t._v(" "),n("ul",[n("li",[t._v("Process是一个全局的对象，无需require直接使用，提供进程描述")]),t._v(" "),n("li",[t._v("process对象是EventEmiter的实例，暴露了进程事件的钩子\n"),n("ul",[n("li",[t._v("exit 监听进程退出")]),t._v(" "),n("li",[t._v("uncaughException 监听异常")])])]),t._v(" "),n("li",[t._v("提供标准的输出，对应的是进程的I/O操作\n"),n("ul",[n("li",[t._v("node版本的console底层是由stdio实现的")]),t._v(" "),n("li",[t._v("数据流与其他双工数据流不同，同步写会阻塞进程导致性能开销")])])])]),t._v(" "),n("h4",{attrs:{id:"nodejs进程创建-child-process-子进程-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nodejs进程创建-child-process-子进程-cluster"}},[t._v("#")]),t._v(" Nodejs进程创建-child_process(子进程)/cluster")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("child_process 是 Node.js的内置模块")]),t._v(" "),n("ul",[n("li",[t._v("spawn：适用于返回大量数据，例如图像处理，二进制数据处理")]),t._v(" "),n("li",[t._v("exec：适用于小量数据，maxBuffer默认值为200*1024超出崩溃")]),t._v(" "),n("li",[t._v("fork：衍生新的进程，进程之间是相互独立的，每个进程独立")])])]),t._v(" "),n("li",[n("p",[t._v("cluster 是Node.js 的内置模块")]),t._v(" "),n("ul",[n("li",[t._v("Worker 对象包含了关于工作进程的所有公共的信息和方法")]),t._v(" "),n("li",[t._v("fork：衍生新的进程，进程之间是相互独立的，每个进程独立")]),t._v(" "),n("li",[t._v("使用主从模型轮询处理服务的负载任务，通过IPC通信")])])])]),t._v(" "),n("h4",{attrs:{id:"进程守护"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#进程守护"}},[t._v("#")]),t._v(" 进程守护")]),t._v(" "),n("p",[t._v("pm2")]),t._v(" "),n("h3",{attrs:{id:"_1-3-4-扩展资料"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-扩展资料"}},[t._v("#")]),t._v(" 1.3.4 扩展资料")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.fundebug.com/2019/01/15/diffrences-of-browser-and-node-in-event-loop/",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器与Node的事件循环(Event Loop)有何区别?"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://itbilu.com/nodejs/core/N1tv0Pgd-.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs原生模块整理"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/entry/5b4b5081e51d451984696cb7",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs中的模块机制"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/5d43017be51d4561f40adcf9",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入理解Nodejs中的进程与线程"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs中文文档站点"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"_1-4-nodejs原生web-server实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-nodejs原生web-server实战"}},[t._v("#")]),t._v(" 1.4 Nodejs原生Web Server实战")]),t._v(" "),n("h3",{attrs:{id:"_1-4-1-web-server的构成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-web-server的构成"}},[t._v("#")]),t._v(" 1.4.1 Web Server的构成")]),t._v(" "),n("ul",[n("li",[t._v("处理HTTP：对HTTP的动词（GET/POST/PUT）进行响应")]),t._v(" "),n("li",[t._v("路由管理：分别处理不同URL路径的请求，返回对应的网络资源")]),t._v(" "),n("li",[t._v("静态文件托管：对网络请求的静态资源进行响应或使用模版动态响应请求")]),t._v(" "),n("li",[t._v("文件数据存储：将请求携带的数据存储到文件或则数据库中")])]),t._v(" "),n("h4",{attrs:{id:"web-server的基本架构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#web-server的基本架构"}},[t._v("#")]),t._v(" Web Server的基本架构")]),t._v(" "),n("p",[n("img",{attrs:{src:a(285),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_1-4-2-web-server的优势"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-web-server的优势"}},[t._v("#")]),t._v(" 1.4.2 Web Server的优势")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("并发性能优势")]),t._v(" "),n("p",[t._v("基于事件驱动的服务在响应请求的场景中有极高的并发性能表现")])]),t._v(" "),n("li",[n("p",[t._v("javascript")])])]),t._v(" "),n("p",[t._v("减少学习成本，使用最流行的javascript或其他可编译/转换为javascript的语言均可实现")]),t._v(" "),n("ul",[n("li",[t._v("生态活跃完善")])]),t._v(" "),n("p",[t._v("npm提供了数十万个可重用的工具包，它还提供了一流的依赖解决方案，可实现自动化工具链构建")]),t._v(" "),n("ul",[n("li",[t._v("代码可移植")])]),t._v(" "),n("p",[t._v("兼容各种操作系统运行环境，一份代码可以运行在多种环境中")]),t._v(" "),n("ul",[n("li",[t._v("框架高度包容")])]),t._v(" "),n("p",[t._v("Node及Node的Web框架都拥有天然的包容性，易于扩展和维护")]),t._v(" "),n("ul",[n("li",[t._v("友好的社区氛围")])]),t._v(" "),n("p",[t._v("丰富的生态诞生了大量的开源社区，聚集了众多优秀的开发人员")]),t._v(" "),n("h3",{attrs:{id:"_1-4-3-web-server的最小系统"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-web-server的最小系统"}},[t._v("#")]),t._v(" 1.4.3 Web Server的最小系统")]),t._v(" "),n("h4",{attrs:{id:"_1-一个简单的http服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-一个简单的http服务"}},[t._v("#")]),t._v(" 1. 一个简单的http服务")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" http"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello World'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("ol",[n("li",[n("p",[t._v("执行 "),n("code",[t._v("node index.js")]),t._v("运行，浏览器访问"),n("code",[t._v("http://localhost:1000/")]),t._v(",")])]),t._v(" "),n("li",[n("p",[t._v("也可以下载包"),n("code",[t._v("nodemon")]),t._v("运行，全局安装的话，运行方式"),n("code",[t._v("nodemon index.js")]),t._v(";局部安装的话用npx运行"),n("code",[t._v("npx nodemon index.js")]),t._v(";也可以在package.json里配置"),n("code",[t._v("script")]),t._v("运行，"),n("code",[t._v('"dev": "nodemon index.js"')])])])]),t._v(" "),n("h4",{attrs:{id:"_2-实现路由处理和静态资源托管"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-实现路由处理和静态资源托管"}},[t._v("#")]),t._v(" 2. 实现路由处理和静态资源托管")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 404处理")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("noFound")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'404.html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'no found'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// res.writeHead(200,{'Content-type':\"text/html;charset='utf-8'\"})")]),t._v("\n            res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-type'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/html;charset=utf-8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.路由处理")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.静态资源托管")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// url.parse解析后会返回一个url对象，pathname是什么？")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 例如：http://nodejs.cn/api/url.html#url_u，pathname是指/api/url.html#url_u")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" pathName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pathName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        pathName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// extname返回扩展名，就是.后面的,如果没有.就返回空字符串")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" extName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("extname")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pathName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("extName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pathName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("noFound")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHead")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-type'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text/html;charset=utf-8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br")])]),n("h4",{attrs:{id:"_3-实现http-verb-和-store"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-实现http-verb-和-store"}},[t._v("#")]),t._v(" 3. 实现http verb 和 store")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 源文档：examples/node/1.4/mini_node")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" http"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" qs"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'qs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("writeDb")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("thunk")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'db'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("thunk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据已被追加到文件'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3.HTTP verb")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4. store")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// url.parse解析后会返回一个url对象，pathname是什么？")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 例如：http://nodejs.cn/api/url.html#url_u，pathname是指/api/url.html#url_u")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" pathName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pathname\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pathName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("startsWith")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/api'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" method"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" query"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" qs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" resData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                code"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sucess'")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" contentType"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content-type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n            \n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contentType"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" postData"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n                req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("thunk")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    postData"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v("thunk\n                    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeDb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thunk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("thunk")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        code"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("postData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                        msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sucess'")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          \n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br")])]),n("h3",{attrs:{id:"_1-4-3-扩展"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-扩展"}},[t._v("#")]),t._v(" 1.4.3 扩展")]),t._v(" "),n("p",[n("a",{attrs:{href:"http://nodejs.cn/api/http.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs官网 http模块"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/5d5277a7f265da03cd0a74a7",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js超详细零基础教程(1)—处理GET、POST请求"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/5b75739ee51d45554762288e",target:"_blank",rel:"noopener noreferrer"}},[t._v("尝试手写一个 nodejs http-server"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"_1-5-使用express搭建web-server"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-使用express搭建web-server"}},[t._v("#")]),t._v(" 1.5 使用Express搭建Web server")]),t._v(" "),n("h3",{attrs:{id:"_1-5-1-express-框架概览"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-1-express-框架概览"}},[t._v("#")]),t._v(" 1.5.1 Express 框架概览")]),t._v(" "),n("ul",[n("li",[t._v("高度包容，快速而简单的Node.js Web框架")]),t._v(" "),n("li",[t._v("拥有稳定可靠丰富的社区和中间件生态")]),t._v(" "),n("li",[t._v("易于学习，可定制程度高，开箱即用")]),t._v(" "),n("li",[t._v("精巧的Express为Web和移动应用程序提供了一组强大的功能")])]),t._v(" "),n("h3",{attrs:{id:"_1-5-2-express的能力"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-2-express的能力"}},[t._v("#")]),t._v(" 1.5.2 Express的能力")]),t._v(" "),n("ul",[n("li",[t._v("封装http模块，方便地创建Web应用")]),t._v(" "),n("li",[t._v("通过中间件机制实现可扩展性")]),t._v(" "),n("li",[t._v("提供路由机制，便于组织业务应用")]),t._v(" "),n("li",[t._v("提供多种模版引擎，支持了静态文件的渲染和托管")]),t._v(" "),n("li",[t._v("便于添加错误处理，方便对系统进行容错处理")]),t._v(" "),n("li",[t._v("便于添加数据库连接，操作数据库数据")])]),t._v(" "),n("h4",{attrs:{id:"express中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express中间件"}},[t._v("#")]),t._v(" Express中间件")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("路由和中间件是Express的基础，路由是特殊的中间件")])]),t._v(" "),n("li",[n("p",[t._v("Express是一系列中间件函数调用的过程")])]),t._v(" "),n("li",[n("p",[t._v("中间件是对处理过程的封装，输入请求对象/响应对象，通过next进入下一个中间件处理过程")])]),t._v(" "),n("li",[n("p",[t._v("使用app.use()将中间件注册到应用实例上，路由中间件注册到路由实例上")])])]),t._v(" "),n("p",[n("img",{attrs:{src:a(286),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"编写express中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编写express中间件"}},[t._v("#")]),t._v(" 编写Express中间件")]),t._v(" "),n("p",[n("img",{attrs:{src:a(287),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"express-路由机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express-路由机制"}},[t._v("#")]),t._v(" Express 路由机制")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("路由是一段Express代码，它将http动词、URL路径/模式和处理函数三者关联起来")])]),t._v(" "),n("li",[n("p",[t._v("Express的应用程序设计要从路由设计入手，将服务的能力描述起来")])]),t._v(" "),n("li",[n("p",[t._v("还可以使用Router中间件，实现路由逻辑模块化设计")])])]),t._v(" "),n("p",[n("img",{attrs:{src:a(288),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"express-性能评估"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express-性能评估"}},[t._v("#")]),t._v(" Express 性能评估")]),t._v(" "),n("p",[n("img",{attrs:{src:a(289),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"express-最佳实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express-最佳实践"}},[t._v("#")]),t._v(" Express 最佳实践")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("使用中间件压缩响应数据，在反向代理层做最佳")])]),t._v(" "),n("li",[n("p",[t._v("避免在业务逻辑处理中使用同步阻塞操作")])]),t._v(" "),n("li",[n("p",[t._v("引入完善的基建保障，记录日志，处理异常")])]),t._v(" "),n("li",[n("p",[t._v("需要重启的时候立即重启，保证程序可以自动重启启动")])])]),t._v(" "),n("h3",{attrs:{id:"_1-5-3-express-web-server实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-3-express-web-server实战"}},[t._v("#")]),t._v(" 1.5.3 Express Web Server实战")]),t._v(" "),n("ul",[n("li",[t._v("实现一个可以生成邮件的模版管理系统")]),t._v(" "),n("li",[t._v("有配置界面，可以沉淀业务域中的邮件模版，可以新增模版")]),t._v(" "),n("li",[t._v("可以预览最终的邮件样式")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(290),alt:""}})]),t._v(" "),n("h4",{attrs:{id:"邮件模版系统-功能设计"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#邮件模版系统-功能设计"}},[t._v("#")]),t._v(" 邮件模版系统-功能设计")]),t._v(" "),n("p",[n("img",{attrs:{src:a(291),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_1-5-4扩展学习"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-4扩展学习"}},[t._v("#")]),t._v(" 1.5.4扩展学习")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/learn/Server-side/Express_Nodejs/Introduction",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN 中提供的 Express 课程"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://cythilya.github.io/2014/11/23/nodejs-express-microblog/",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 Node.js + Express 搭建一个简单的微博网站"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/56947560",target:"_blank",rel:"noopener noreferrer"}},[t._v("NodeJS express框架核心原理全揭秘"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"_1-6-使用nodejs编写-restful-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-使用nodejs编写-restful-api"}},[t._v("#")]),t._v(" 1.6 使用Nodejs编写 RESTful API")]),t._v(" "),n("h3",{attrs:{id:"_1-6-1-restful-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-1-restful-api"}},[t._v("#")]),t._v(" 1.6.1 RESTful API")]),t._v(" "),n("p",[t._v("rest是暴露服务端资源的一种约定方式，同时提供获取这种资源的动词，基于rest架构的web server api，我们就称为RESTful API。")]),t._v(" "),n("h4",{attrs:{id:"rest概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rest概念"}},[t._v("#")]),t._v(" REST概念")]),t._v(" "),n("ul",[n("li",[t._v("URI资源定位")])]),t._v(" "),n("p",[t._v("REST是面向资源，而资源通过URI进行暴露")]),t._v(" "),n("ul",[n("li",[t._v("链接资源状态")])]),t._v(" "),n("p",[t._v("服务器生成包含状态转移的表征数据，用来响应客户端对一个资源的请求，客户端可据此了解状态转移的方式")]),t._v(" "),n("ul",[n("li",[t._v("使用HTTP已有特性")])]),t._v(" "),n("p",[t._v("REST很用利用了HTTP本身的一些特性，如HTTTP动词、HTTP状态码、HTTP头部信息")]),t._v(" "),n("ul",[n("li",[t._v("统一资源规范")])]),t._v(" "),n("p",[t._v("包含一组受限的预定义的操作，资源都通过使用项目接口进行资源的访问")]),t._v(" "),n("h4",{attrs:{id:"充分利用http描述uri资源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#充分利用http描述uri资源"}},[t._v("#")]),t._v(" 充分利用HTTP描述URI资源")]),t._v(" "),n("p",[n("img",{attrs:{src:a(292),alt:""}})]),t._v(" "),n("h3",{attrs:{id:"_1-6-2-rest-工程实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-2-rest-工程实践"}},[t._v("#")]),t._v(" 1.6.2 REST 工程实践")]),t._v(" "),n("h3",{attrs:{id:"rest-接口设计-路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rest-接口设计-路由"}},[t._v("#")]),t._v(" REST 接口设计-路由")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//接口要遵循http动词")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GET")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("v1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("templateList "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取模版列表")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GET")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("v1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("templateDetail"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xx   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模版单个模版详情")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("POST")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("v1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("templateCreate "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建模版")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PUT")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("v1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("templateChange"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改模版,")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DELETE")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("v1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("templateDelate"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 删除模版")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("h3",{attrs:{id:"数据表设计-封装数据服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据表设计-封装数据服务"}},[t._v("#")]),t._v(" 数据表设计-封装数据服务")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("选用MongoDB存储数据")])]),t._v(" "),n("li",[n("p",[t._v("引用mongoose构建数据模型")])]),t._v(" "),n("li",[n("p",[t._v("邮件模版Schema")]),t._v(" "),n("ul",[n("li",[t._v("id String 唯一识别邮件模版的id")]),t._v(" "),n("li",[t._v("template text 可支持HTML")]),t._v(" "),n("li",[t._v("data  邮件模版中填充的数据")])]),t._v(" "),n("h3",{attrs:{id:"_1-6-3-rest-最佳实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-3-rest-最佳实践"}},[t._v("#")]),t._v(" 1.6.3 REST 最佳实践")])]),t._v(" "),n("li",[n("p",[t._v("充分理解并使用HTTP请求")])]),t._v(" "),n("li",[n("p",[t._v("使用API测试工具而非浏览器测试你的API接口")])]),t._v(" "),n("li",[n("p",[t._v("选择合适的文档生成工具，删除API文档")])]),t._v(" "),n("li",[n("p",[t._v("REST只是规范并不强制，最合适团队的才是最好的")])]),t._v(" "),n("li",[n("p",[t._v("找个实践REST较好的框架胜过自己造轮子")])])]),t._v(" "),n("p",[t._v("🍅 开始实战")]),t._v(" "),n("ol",[n("li",[t._v("项目结构")])]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v(" ├── server    \n │   ├──  middleware "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 自己写的中间件；可以用于处理一些业务逻辑")]),t._v("\n │   ├──  model      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据模型，接口的数据模型")]),t._v("\n │   ├──  routes     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 接口的业务代码")]),t._v("\n │   ├── index.js    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 入口文件")]),t._v("\n └─ package.json     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 管理项目运行的依赖、及描述信息                                  ")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("下载所需要的依赖")])]),t._v(" "),n("p",[n("code",[t._v("yarn add express mongoose nodemon body-parser")])]),t._v(" "),n("p",[t._v("mongoose ：简化操作mongodb的库")]),t._v(" "),n("p",[t._v("body-parser：处理post请求时返回thunk，它会自动帮我们加入res.body中")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[t._v("用nodemon启动项目，当我们保存时，nodemon会帮助我们启动项目\n"),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"dev"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nodemon server/index.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("编写入口文件index.js")])]),t._v(" "),n("p",[t._v("编写入口文件，需要连接数据库，这里我们使用mogodb，mongodb的安装教程在本文的最下面，当然会mysql，也可以用mysql。")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bodyParser"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body-parser'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mongoose"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongoose'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" templateRouter"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./routes/template'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 连接mongodb，temp是我们数据库的名称")]),t._v("\nmongoose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongodb://127.0.0.1:27017/temp'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    useNewUrlParser"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    useUnifiedTopology"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mongoose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connection\ndb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'监听错误'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听mogodb是否连接成功")]),t._v("\ndb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("once")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'数据库连接成功'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 我们编写的中间件，提供$sucess和#error来处理返回的数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./middleware/index'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用bodyParser处理post请求，处理返回chunk")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("urlencoded")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    extended"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 我们的路由前缀/xhr/v1/，如果匹配在url中匹配到了/xhr/v1/，就会进入子路由templateRouter")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/xhr/v1/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("templateRouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 前面都没有匹配到调用next()就会进入下一个中间件")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" err "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Not Found'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'server is running on http://localhost:2000'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[t._v("在model中编写数据模型")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据模型")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mongoose"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mongoose'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" templateSchema"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mongoose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Schema")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    template"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("String"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("String\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//第一个参数 当前模型名称，第二个参数 schema")]),t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mongoose"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("model")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'template'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("templateSchema"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br")])]),n("ol",{attrs:{start:"5"}},[n("li",[t._v("编写处理返回数据的中间件")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 处理错误的中间件")]),t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("$success")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("code"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" _data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            code\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            _data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sucess'")]),t._v("\n            _data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("data\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            _data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("data\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("$error")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("code"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" _data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            code\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'objcet'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            _data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),t._v("\n            _data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            _data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("err\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br")])]),n("ol",{attrs:{start:"6"}},[n("li",[t._v("在routes编写业务接口")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 路由模块，业务模块")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" router"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Router")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Template"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../model/template'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查询模版列表")]),t._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/templateList'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" temps"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Template"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("sort")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("update_at"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$success")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建模版")]),t._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/templateCreate'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" temps "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Template"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$success")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查询模版详情")]),t._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/templateDetail'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" temps "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Template"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("findById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$success")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新模版")]),t._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/templateChange/:id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" temps "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Template"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("findByIdAndUpdate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$success")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 删除模版")]),t._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/templateDelate/:id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("params\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" temps "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Template"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("findByIdAndRemove")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$success")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("temps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("router\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br")])]),n("ol",{attrs:{start:"7"}},[n("li",[t._v("其它")])]),t._v(" "),n("p",[t._v("测试接口可以用postman")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[t._v("请求创建模版接口示例：http"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:2000/xhr/v1/templateCreate")]),t._v("\n在headers要加入Content-Type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("application/json\n请求的参数：\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"template"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<h1>express<h1>"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"{name:'test1'}\"")]),t._v("\n\t\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n返回的数据，其中_id是mongodb为我们创建的\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sucess"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"_id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5f2c19c81a53ff25e7d94953"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"template"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<h1>express<h1>"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"{name:'test1'}\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"__v"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 源码地址")]),t._v("\n https"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("github"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hejialianghe"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Senior"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("FrontEnd"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("tree"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("master"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("examples"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("node"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.6")]),t._v("\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[t._v("🍅 安装mongodb")]),t._v(" "),n("p",[n("font",{attrs:{color:"red"}},[n("strong",[t._v("window下安装mongodb")])])],1),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 1. 下载安装")])],1),t._v(" "),n("p",[t._v("传送门：https://www.mongodb.com/download-center/community")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 2. 配置数据库数据存放目录和日志存放目录")])],1),t._v(" "),n("p",[t._v("例如在D盘下创建数据目录")]),t._v(" "),n("p",[t._v("mkdir D:\\data\\db")]),t._v(" "),n("p",[t._v("创建日志目录")]),t._v(" "),n("p",[t._v("mkdir D:\\data\\log")]),t._v(" "),n("p",[t._v("数据和日志放哪都可以，不一定是D盘")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 3. 配置mongod.cfg")])],1),t._v(" "),n("p",[t._v("进入C盘C:\\mongodb目录下创建mongod.cfg文件，并把以下内容复制进去")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("storage:\n  dbPath:  D:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("db\n  journal:\n    enabled: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\nsystemLog:\n  destination: "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v("\n  logAppend: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  path:  D:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("mongod.log\nnet:\n  port: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v("\n  bindIp: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 权限验证,是否用密码连接数据库，开始不要设置密码，如果设置权限验证，就把#去掉")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#security:")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#authorization: enabled")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 4. 安装mongodb服务")])],1),t._v(" "),n("p",[t._v("在C:\\mongodb\\bin目录下打开shell，并执行以下命令")]),t._v(" "),n("p",[t._v('mongod.exe --config "C:\\mongodb\\mongod.cfg" --install')]),t._v(" "),n("p",[t._v("启动mongodb服务")]),t._v(" "),n("p",[t._v("net start MongoDB")]),t._v(" "),n("p",[t._v("如果执行成功，会输出以下信息")]),t._v(" "),n("p",[t._v("2015-09-25T15:54:09.212+0800 I CONTROL  Hotfix KB2731284 or later update is notinstalled, will zero-out data files2015-09-25T15:54:09.229+0800 I JOURNAL  [initandlisten] journal dir=c:\\data\\db\\j\nournal2015-09-25T15:54:09.237+0800 I JOURNAL  [initandlisten] recover : no journal fil\nes present, no recovery needed2015-09-25T15:54:09.290+0800 I JOURNAL  [durability] Durability thread started2015-09-25T15:54:09.294+0800 I CONTROL  [initandlisten] MongoDB starting : pid=2488 port=27017 dbpath=c:\\data\\db 64-bit host=WIN-1VONBJOCE882015-09-25T15:54:09.296+0800 I CONTROL  [initandlisten] targetMinOS: Windows 7/W\nindows Server 2008 R22015-09-25T15:54:09.298+0800 I CONTROL  [initandlisten] db version v3.0.6")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 5. 其它指令")])],1),t._v(" "),n("p",[t._v("net stop MongoDB //关闭MongoDB服务")]),t._v(" "),n("p",[t._v("mongod.exe --remove  //移除 MongoDB 服务，要在C:\\mongodb\\bin目录下打开shel执行该命令或点击mongo.exe")]),t._v(" "),n("p",[t._v("mongo.exe //进入mongodb管理后台，要在C:\\mongodb\\bin目录下打开shell执行该命令或点击mongo.exe")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 6. window版数据库管理工具navicatmongodb")])],1),t._v(" "),n("p",[t._v("链接: https://pan.baidu.com/s/14NYuD-rkG7p4YsX3UZgBOA 提取码: xeah")]),t._v(" "),n("p",[n("font",{attrs:{color:"red"}},[n("strong",[t._v("mac下安装mongodb（linux上同理）")])])],1),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 1. mac下安装mongodb")])],1),t._v(" "),n("p",[t._v("手动安装")]),t._v(" "),n("p",[t._v("传送门：https://www.mongodb.com/download-center/community")]),t._v(" "),n("p",[t._v("1.打开finder按shift+command+g 输入/usr/local 进入这个目录下")]),t._v(" "),n("p",[t._v("2.在/usr/local下创建mongodb文件夹")]),t._v(" "),n("p",[t._v("3.把下载好的包拖入/usr/local/mongodb目录下")]),t._v(" "),n("p",[t._v("4打开命令行输入cd /usr/local/mongodb")]),t._v(" "),n("p",[t._v("5.解压")]),t._v(" "),n("p",[t._v("sudo tar zxvf mongodb-linux-x86_64-rhel70-4.2.0.tgz //解压，手动点击也可以")]),t._v(" "),n("p",[t._v("6.修改文件名")]),t._v(" "),n("p",[t._v("sudo mv mongodb-linux-x86_64-rhel70-4.2.0 mongodbserver  //修改文件名，手动修改也可以")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 2. 创建data和log")])],1),t._v(" "),n("p",[t._v("sudo mkdir data  //创建data文件")]),t._v(" "),n("p",[t._v("sudo mkdir log  //创建log文件")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 3. 在/usr/local/mongodb/目录下创建配置文件mongod.conf")])],1),t._v(" "),n("p",[t._v("1.vim  /usr/local/mongodb/mongod.conf //编辑文件，命令行中执行")]),t._v(" "),n("p",[t._v("2.输入i 进入输入模式")]),t._v(" "),n("p",[t._v("3.把以下内容复制到mongod.conf文件里")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("  "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dbpath")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/mongodb/data/  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#数据存放路径 ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("logpath")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/mongodb/log/mongodb.log "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#日志存放路径")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("fork")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#后台运行 bind_ip=0.0.0.0 #允许任何IP进行连接 ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("auth")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("false "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#true是要进行密码验证连接数据库，false不需要")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("p",[t._v("4.按esc 进入编辑")]),t._v(" "),n("p",[t._v("5.按 ：进入末尾")]),t._v(" "),n("p",[t._v("6.按 wq 进行保存并退出")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 4. 配置全局环境变量")])],1),t._v(" "),n("p",[t._v("1.vim /etc/profile //进入编辑profile模式，命令行中执行")]),t._v(" "),n("p",[t._v("2.把以下内容复制到profile中")]),t._v(" "),n("p",[t._v("export PATH=$PATH:/usr/local/mongodb/mongodbserver/bin")]),t._v(" "),n("p",[t._v("3.按esc 进入编辑,.按 ：进入末尾,按 wq 进行保存并退出")]),t._v(" "),n("p",[t._v("4.source /etc/profile //重新加载,命令行中执行")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 5. 启动mongodb")])],1),t._v(" "),n("p",[t._v("mongod --config /usr/local/mongodb/mongod.conf //命令行中运行")]),t._v(" "),n("p",[t._v("显示：child process started sucessfully，parent exiting 说明运行成功")]),t._v(" "),n("p",[t._v("查看mongodb是否启动成功")]),t._v(" "),n("p",[t._v("ps -ef | grep mongodb")]),t._v(" "),n("p",[t._v("ps -axu |grep mongo  获取进程号")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 6. 创建数据库")])],1),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("mongo "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 连接数据库")]),t._v("\nuse temp "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#temp就是我们创建的数据库，用show dbs 查看数据库是不显示的，因为里面没有数据")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br")])]),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 7. 其他指令")])],1),t._v(" "),n("p",[t._v("mongorestore -h 127.0.0.1:27017 -d testdata --drop /home/data/  // 导入数据，testdata是数据库的名称，/home/data/是老数据存放地址")]),t._v(" "),n("p",[t._v("mongod --shutdown --dbpath  /usr/local/mongodb/data/ //关掉服务")]),t._v(" "),n("p",[t._v("数据库用户及权限管理")]),t._v(" "),n("p",[t._v("提示：如果想进行账号密码连接数据库，请看1，2，3，4，,5设置密码后请修改")]),t._v(" "),n("p",[t._v("mongodb.conf 里的配置项auth=true")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v("mongo "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//命令行输入")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v("use admin "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//进入admin")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createUser")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pwd"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("roles"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("role"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userAdminAnyDatabase"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建超级管理员")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.")]),t._v("use testdata "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//进入testdata数据库")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createUser")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("pwd"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("roles"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("role"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"readWrite"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("db"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"testdata"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//建立testdata数据库管理员")]),t._v("\n\ndb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("auth")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建完成后可以进行管理员验证，看是否设置成功")]),t._v("\n\ndb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("changeUserPassword")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//修改用户密码")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("p",[t._v("show users //查看已有用户")]),t._v(" "),n("p",[t._v("show dbs  //查询数据库列表")]),t._v(" "),n("p",[n("font",{attrs:{color:"blue"}},[t._v(" 8. mac下数据库管理工具Robo")])],1),t._v(" "),n("p",[t._v("传送门：https://robomongo.org/download")])])}),[],!1,null,null,null);s.default=e.exports},70:function(t,s,a){t.exports=a.p+"assets/img/buffer.63dacdd4.png"}}]);