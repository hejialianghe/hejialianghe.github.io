(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{395:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_4-1-工程设计范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-工程设计范式"}},[s._v("#")]),s._v(" 4.1 工程设计范式")]),s._v(" "),t("ul",[t("li",[s._v("工程设计范式有哪些种类")])]),s._v(" "),t("p",[s._v("Rails Style / Domain Style")]),s._v(" "),t("ul",[t("li",[s._v("相信很多有一定经验的开发者都会遇到选择这种问题\n"),t("ul",[t("li",[s._v("一个看似分层良好的古老工程，随着业务发展却越来越臃肿和低效")]),s._v(" "),t("li",[s._v("一个新的项目，因为这种隐形问题上的纠结，而耽误了自己时间和精力")])])])]),s._v(" "),t("h3",{attrs:{id:"_4-1-1-工程范式分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-工程范式分类"}},[s._v("#")]),s._v(" 4.1.1 工程范式分类")]),s._v(" "),t("h4",{attrs:{id:"rails-style"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rails-style"}},[s._v("#")]),s._v(" 🍅 Rails Style")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// egg应用典型结构")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("── app               \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── config     \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── controller\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── extend\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── router"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ts\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── service\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── view      \n├── app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ts                    \n├── agent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ts\n├── config\n├── logs\n├── test\n├── typings\n├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n├── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json            \n└── yarn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lock\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Rails Style TodoList")]),s._v("\nroot\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("── reducers              \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── todoReducer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── fileterReducer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n├── actions                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── todoActions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js                         \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── filterAction"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n├── components                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── todoList"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── todoItem"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx               \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── filter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx\n├── containers                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── todoListContainer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── todoItemContainer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx               \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── filterContainer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx\n├── App"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jsx\n└── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("Rails Style的特点")]),s._v(" "),t("ul",[t("li",[s._v("专注于纵向的“层”的划分")]),s._v(" "),t("li",[s._v("同一类文件放置在同一目录下")])])]),s._v(" "),t("li",[t("p",[s._v("优势：")]),s._v(" "),t("ul",[t("li",[s._v("便于合并导出")]),s._v(" "),t("li",[s._v("便于进行“层”的扩展")])])]),s._v(" "),t("li",[t("p",[s._v("不足：")]),s._v(" "),t("ul",[t("li",[s._v("依赖关系难以直接地分析")]),s._v(" "),t("li",[s._v("对功能的修改会涉及到大量的目录切换")]),s._v(" "),t("li",[s._v("难以水平拆分")])])])]),s._v(" "),t("p",[s._v("🍅 Domain style")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Aant Design")]),s._v("\n├── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("                            \n├── components                \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── util \n        └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("    \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── alert             \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── demo         \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("en"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("US")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("msd    \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tsx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── style\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── anchor             \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── Anchor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tsx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── AnchorLink"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tsx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── __tests__\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── demo\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("en"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("US")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("msd    \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tsx\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("zh"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CN")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── style\n└── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("Domain style的特点")]),s._v(" "),t("ul",[t("li",[s._v("专注于横向的 “功能” 的划分")]),s._v(" "),t("li",[s._v("同一个feature放置在同一目录下")])])]),s._v(" "),t("li",[t("p",[s._v("优势：")]),s._v(" "),t("ul",[t("li",[s._v("便于水平拆分")]),s._v(" "),t("li",[s._v("便于进行“功能”的扩展")])])]),s._v(" "),t("li",[t("p",[s._v("不足")]),s._v(" "),t("ul",[t("li",[s._v("会产生大量的重复结构")]),s._v(" "),t("li",[s._v("难以垂直拆分")])])])]),s._v(" "),t("h3",{attrs:{id:"_4-1-2-如何选择工程范式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-如何选择工程范式"}},[s._v("#")]),s._v(" 4.1.2 如何选择工程范式")]),s._v(" "),t("ul",[t("li",[s._v("单一功能的项目\n"),t("ul",[t("li",[s._v("库、三方包：fs-extra、axios等")]),s._v(" "),t("li",[s._v("由于不存在水平拆分的必要性、故可以选择Rails Style")]),s._v(" "),t("li",[s._v("易于扩展")]),s._v(" "),t("li",[s._v("减少重复代码")])])])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Axios")]),s._v("\nroot\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("── dist              \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n├── examples                                     \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n├── lib                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── adapters\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── cancel\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── core\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("   \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── defaults"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js       \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── axios"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n├── sandbox                                     \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n├── test                                    \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n├── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n└── webpack"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("聚合功能型项目")]),s._v(" "),t("ul",[t("li",[s._v("组件池、utils：ant-design、element-ui、lodash等")]),s._v(" "),t("li",[s._v("纵向分层少，极易横向扩展-故选择Domain Style")]),s._v(" "),t("li",[s._v("易于添加新feature")]),s._v(" "),t("li",[s._v("便于横向拆分")])])]),s._v(" "),t("li",[t("p",[s._v("业务工程项目")]),s._v(" "),t("ul",[t("li",[s._v("即有大量的垂直分层，又有大量的feature聚合")]),s._v(" "),t("li",[s._v("Rails Style + Domain Style")])])])]),s._v(" "),t("h4",{attrs:{id:"rails-style-对比-domain-style"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rails-style-对比-domain-style"}},[s._v("#")]),s._v(" 🍅  Rails Style 对比 Domain Style")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("工程设计范式")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("特点")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("优势")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("不足")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("适用项目")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("Rails Style")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("纵向“层”的划分，同一类文件放置在同一目录下")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("便于合并导出，便于进行“层”的扩展")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("依赖关系难以直观地分析，对功能的修改会涉及到大量的目录切换 ，难以水平拆分")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("单一功能的项目")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("Domain Style")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("横向“功能”的划分，同一feature放置在同一目录下")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("便于水平拆分，便于进行“功能”的扩展")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("会产生大量的重复结构，难以垂直拆分")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("聚合功能型项目")])])])]),s._v(" "),t("p",[s._v("业务工程项目一般需要Rails Style 和 Domain Style结合")]),s._v(" "),t("h2",{attrs:{id:"_4-2-multi-repo-vs-mono-repo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-multi-repo-vs-mono-repo"}},[s._v("#")]),s._v(" 4.2 multi-repo VS mono-repo")]),s._v(" "),t("p",[s._v("它们是什么？")]),s._v(" "),t("p",[s._v("这是两种代码风格仓库的管理风格")]),s._v(" "),t("ul",[t("li",[s._v("multi-repo：把每个项目都分别用git托管")]),s._v(" "),t("li",[s._v("mono-repo：统一用一个git仓库管理所有的项目")])]),s._v(" "),t("h3",{attrs:{id:"_4-2-1-multi-repo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-multi-repo"}},[s._v("#")]),s._v(" 4.2.1  multi-repo")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// multi-repo")]),s._v("\nroot\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a          \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git\n├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("b                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("                    \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── git\n├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git\n├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d                 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   ├── "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("    \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   └── "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("从上面可以看出多个项目对应多个仓库，大多数工程，其实都是以multi-repo方式管理的")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("优势：")]),s._v(" "),t("p",[s._v("可以让各项目团队根据需要定制更适合自己的workflow")])]),s._v(" "),t("li",[t("p",[s._v("不足：")]),s._v(" "),t("ol",[t("li",[s._v("难以对所有项目统一进行操作（git checkout / npm publish / npm run build）")]),s._v(" "),t("li",[s._v("难以追踪依赖关系（a->b->c）")])])])]),s._v(" "),t("h3",{attrs:{id:"_4-2-2-mono-repo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-mono-repo"}},[s._v("#")]),s._v(" 4.2.2  mono-repo")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// multi-repo")]),s._v("\n\n├── "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git \n├── lerna"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n├── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json                                        \n├── packages                 \n    ├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── __tests__\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── lib\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    └── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n    ├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("b\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── __tests__\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── lib\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    └── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n    ├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c\n        ├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n        ├── __tests__\n        ├── lib\n        └── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("广泛应用于一些知名开源项目和硅谷巨头（React/Angular/Vuetify/Google）")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("优势")]),s._v(" "),t("ol",[t("li",[s._v("方便统一地操作各个项目（git checkout / npm publish / npm run build）")]),s._v(" "),t("li",[s._v("利用工具，可以方便地追踪项目间的依赖关系")])])]),s._v(" "),t("li",[t("p",[s._v("不足：")]),s._v(" "),t("ol",[t("li",[s._v("代码库随着业务发展会非常巨大")]),s._v(" "),t("li",[s._v("失去部分的灵活性（workflow必须统一）")]),s._v(" "),t("li",[s._v("强依赖于mono-repo的管理工具")])])])]),s._v(" "),t("h3",{attrs:{id:"_4-2-3-multi-repo的管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-multi-repo的管理"}},[s._v("#")]),s._v(" 4.2.3  multi-repo的管理")]),s._v(" "),t("ul",[t("li",[s._v("git submodule")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化git submodules仓库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" submodule init\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加一个submodule")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" submodule "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" https://github.com\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新所有的submodule")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" submodule update\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查submodule status")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("  submodule status\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# foreach 用于在每个submodule中执行命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" submodule foreach "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git checkout -b featureA"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("ul",[t("li",[s._v("git提供的一种管理子仓库的方案")]),s._v(" "),t("li",[s._v("可以批量管理多个git repo")]),s._v(" "),t("li",[s._v("本质上是一个父repo维护了一份各个子repo的清单")]),s._v(" "),t("li",[s._v("坑还是不少的：git Submodule的坑")]),s._v(" "),t("li",[s._v("替代方案：git  subtree")])]),s._v(" "),t("h3",{attrs:{id:"_4-2-4-mono-repo的管理-lerna"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-4-mono-repo的管理-lerna"}},[s._v("#")]),s._v(" 4.2.4 mono-repo的管理-lerna")]),s._v(" "),t("ul",[t("li",[s._v("为js生态下的mono-repo管理提供一站式的解决方案")]),s._v(" "),t("li",[s._v("babel/create-react-app/jest/react-router/umi/nestjs")])]),s._v(" "),t("p",[s._v("解决方案：")]),s._v(" "),t("p",[s._v("mono-repo下的依赖管理、版本管理、开发提效、工作流")]),s._v(" "),t("h4",{attrs:{id:"目录结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[s._v("#")]),s._v(" 目录结构")]),s._v(" "),t("ul",[t("li",[s._v("整体作为一个Git仓库，也是个npm包（私有）")]),s._v(" "),t("li",[s._v("lerna.json是整个mmono-repo的配置文件")]),s._v(" "),t("li",[s._v("每个真正的项目，平铺在packages/中")]),s._v(" "),t("li",[s._v("整个项目可以统一管理所有依赖（也可以分别管理）")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// lerna")]),s._v("\n├── "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git \n├── lerna"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n├── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json                                        \n├── packages                 \n    ├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── __tests__\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── lib\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    └── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n    ├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("b\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── __tests__\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    ├── lib\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("    └── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n    ├── project"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c\n        ├── "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("README")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("md\n        ├── __tests__\n        ├── lib\n        └── "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h4",{attrs:{id:"用lerna管理项目实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用lerna管理项目实战"}},[s._v("#")]),s._v(" 用lerna管理项目实战 "),t("Badge",{attrs:{text:"重要",type:"tip"}})],1),s._v(" "),t("p",[s._v("用lerna管理项目实战")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i lerna -g\nlerna init\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",[t("li",[s._v("初始化的目录结构")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[s._v("- packages\n  - lerna.json\n  - package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建项目1")]),s._v("\nlerna create pac-1\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建项目3")]),s._v("\nlerna create pac-2\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建项目3")]),s._v("\nlerna create pac-3\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("目录中 lerna.jsoon")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 配置$schema可以在vscode中，鼠标滑倒每个配置项时候，可以看每个配置项的介绍 ")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 可以在https://www.schemastore.org/json/中网站查看知名项目的描述文件")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"$schema"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://json.schemastore.org/lerna"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"packages"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/*"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"independent"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 可以给各个项目发不同的版本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("接下来我们为pac-1、 pac-2、pac-3添加依赖关系，我们制造这样一种依赖，pac-1模块被pac-2依赖；pac-2模块被pac-3模块依赖，\n这时候就形成了pac-1、 pac-2、pac-3间接依赖关系。")])]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("添加项目依赖")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 制造依赖关系，对于内部项目的依赖，lerna会以软连接的形式，给它们相互软链接起来")]),s._v("\nlerna "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" pac-1 packages/pac-2\nlerna "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" pac-2 packages/pac-3\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("如果我们给项目添加外部依赖，可能需要给每个项目node_moudles都添加，同一个依赖会安装很多次，这显然不合理，为了解决这个问题，leran可以把依赖添加到项目根目录；"),t("code",[s._v("lerna clean")]),s._v("去清除每个项目中node_modules相同的依赖;用 "),t("code",[s._v("lerna bootstrap --hoist")]),s._v("重新安装依赖，")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("发版")])]),s._v(" "),t("p",[s._v('需要注意是的 lerna.json 配置为"version": "independent"时可以为每个包独立发不同的版本，如果"version":\'0.0.0\'是发同样的版本')]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("leran publish\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("其它")])]),s._v(" "),t("p",[s._v("可以用"),t("code",[s._v("lerna -h")]),s._v("查看全部指令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("lerna  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("cmd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行每一个package.json你想指行的命令")]),s._v("\nlerna run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行package.josn 中script配置的命令")]),s._v("\nlerna "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pkgName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对比 文件变化")]),s._v("\nlerna changed "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看文件变化")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"lerna-json-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-json-配置"}},[s._v("#")]),s._v(" lerna.json 配置")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"npmClient"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"npmClientArgs"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--pure-lockfile"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"command"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"publish"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"ignoreChanges"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ignored-file"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.md"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"message"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"chore(replease):publish"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"registry"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://npm.pkg.github.com"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"bootstrap"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"ignore"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"component-*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"npmClientArgs"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--no-package-lock"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"packages"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("其实只有几个主要字段：version、npm*、command、packages")])]),s._v(" "),t("li",[t("p",[s._v("command配置-json schema查看")]),s._v(" "),t("ul",[t("li",[s._v("配置lerna子命令的默认项目")])])]),s._v(" "),t("li",[t("p",[s._v("version: 决定fixed mode / independent mode")])]),s._v(" "),t("li",[t("p",[s._v("packages：项目路径")])]),s._v(" "),t("li",[t("p",[s._v("npm*：解耦包管理工具")])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("一些注意项")]),s._v(" "),t("ul",[t("li",[s._v("mono-repo 不可嵌套")]),s._v(" "),t("li",[s._v("mono-repo 的主仓库必须是私有的（private：true）")]),s._v(" "),t("li",[s._v("如果你对仓库的私密性要求非常高，甚至可以不用npm而使用git应用依赖")]),s._v(" "),t("li",[s._v("任何的json配置记不住，都可以用json schema")])])]),s._v(" "),t("p",[s._v("源码地址：/examples/engineering/4.1/lerna-demo")]),s._v(" "),t("h4",{attrs:{id:"lerna-外的选择-nx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-外的选择-nx"}},[s._v("#")]),s._v(" lerna 外的选择-nx")]),s._v(" "),t("ul",[t("li",[s._v("Angular出品")]),s._v(" "),t("li",[s._v("框架强相关：Angular、React")]),s._v(" "),t("li",[s._v("支持插件机制")]),s._v(" "),t("li",[s._v("远超mono-repo管理的强大功能")])]),s._v(" "),t("h3",{attrs:{id:"扩展资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#扩展资料"}},[s._v("#")]),s._v(" 扩展资料")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.devtang.com/2013/05/08/git-submodule-issues/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Git submodule的坑"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/apenwarr/git-subtree/",target:"_blank",rel:"noopener noreferrer"}},[s._v("git subtree"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.npmjs.org/post/617484925547986944/npm-v7-series-introduction",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm v7 Series - Introduction"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://nx.dev/",target:"_blank",rel:"noopener noreferrer"}},[s._v("NX"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);