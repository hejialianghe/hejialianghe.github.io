(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{215:function(s,a,t){s.exports=t.p+"assets/img/travis.49007598.png"},216:function(s,a,t){s.exports=t.p+"assets/img/travissetting.889c85ed.png"},217:function(s,a,t){s.exports=t.p+"assets/img/access-token.97a9cb25.png"},396:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_6-1-travis与github"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-travis与github"}},[s._v("#")]),s._v(" 6.1  travis与github")]),s._v(" "),n("h4",{attrs:{id:"什么是持续集成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是持续集成"}},[s._v("#")]),s._v(" 什么是持续集成 ？")]),s._v(" "),n("p",[s._v("Travis CI 提供的是持续集成服务，它可以绑定github上的项目，可以指定监视某个分支，只要push了新的代码，就会自动抓取；它提供一个运行环境，执行测试，完成构建，还能部署到服务器。")]),s._v(" "),n("p",[s._v("因为Travis 和github是兄弟，所以目前市场份额最大。")]),s._v(" "),n("h4",{attrs:{id:"我们的要实现的功能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#我们的要实现的功能"}},[s._v("#")]),s._v(" 我们的要实现的功能？")]),s._v(" "),n("p",[s._v("当我们push代码到github仓库的时候，完成自己的服务器（"),n("code",[s._v("blog.youliaowu.com")]),s._v("）和github提供免费的服务器（"),n("code",[s._v("hejialianghe.github.io")]),s._v("）的部署。")]),s._v(" "),n("h3",{attrs:{id:"_6-1-1-前期准备"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-1-前期准备"}},[s._v("#")]),s._v(" 6.1.1 前期准备")]),s._v(" "),n("p",[s._v("首先我们准备一个github账号，然后访问"),n("a",{attrs:{href:"https://www.travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Travis Ci"),n("OutboundLink")],1),s._v("；用github账号去登录;然后点红色标识的按钮更新仓库，点蓝色标识的部分触发某个项目进行构建。")]),s._v(" "),n("p",[n("img",{attrs:{src:t(215),alt:""}})]),s._v(" "),n("h3",{attrs:{id:"_6-1-2-完成hejialianghe-github-io的部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-2-完成hejialianghe-github-io的部署"}},[s._v("#")]),s._v(" 6.1.2 完成hejialianghe.github.io的部署")]),s._v(" "),n("h4",{attrs:{id:"_1-在github上生成token"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-在github上生成token"}},[s._v("#")]),s._v(" 1. 在github上生成token")]),s._v(" "),n("p",[s._v("因为travis在编译好后需要把编译好的代码push到"),n("code",[s._v("hejialianghe.github.io")]),s._v("仓库中去，那肯定需要一个标识去验证，这就是我们生成token的意义！")]),s._v(" "),n("p",[s._v("点自己github右上角的图像-> 点Settings->左边会有一个列表点击Developer settings->在点击Personal access tokens->点击Generate new token->为token起一个名字access_token,列表全部勾选，然后点击Generate token生成。")]),s._v(" "),n("p",[n("font",{attrs:{color:"red"}},[n("strong",[s._v("生成token后不要关闭当前页面，请记下此token；因为它只显示一次，忘记了只能再次生成。")])])],1),s._v(" "),n("h4",{attrs:{id:"_2-给travis设置环境变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-给travis设置环境变量"}},[s._v("#")]),s._v(" 2. 给Travis设置环境变量")]),s._v(" "),n("p",[s._v("我们刚刚在github上生成了token，把这个token设置为Travis对应的环境变量上，后面的执行脚本中会用到这个token，为了避免明文token，才设置为环境变量，那下面我们设置环境变量。")]),s._v(" "),n("p",[s._v("我们进入Travis网站，点进构建的项目中去，然后点击右上角蓝色部分->点击Settings")]),s._v(" "),n("p",[n("img",{attrs:{src:t(216),alt:""}})]),s._v(" "),n("p",[s._v("name设置为access_token，value设置为github上生成的token，点击add添加环境变量。")]),s._v(" "),n("p",[n("img",{attrs:{src:t(217),alt:""}})]),s._v(" "),n("h4",{attrs:{id:"_3-在项目根目录建-travis-yml和deploy-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-在项目根目录建-travis-yml和deploy-sh"}},[s._v("#")]),s._v(" 3. 在项目根目录建.travis.yml和deploy.sh")]),s._v(" "),n("p",[s._v(".travis.yml配置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("language: node_js\nnode_js: \n  - lts/* "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置语言版本，lts表示稳定版")]),s._v("\nbranches:\n  only:\n    - master "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置只监听哪个分支")]),s._v("\ncache: "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#缓存")]),s._v("\n  apt: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  yarn: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  directories: \n    - node_modules \ninstall:  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n  - "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v("\nscript:  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 需要执行的脚本")]),s._v("\n    - "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n    - "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" ./deploy.sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("deploy.sh配置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!usr/bin/env sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当发生错误中止脚本")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -e\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd 到构建输出的目录下")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" dist\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -A\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'deploy'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的access_token是travis设置的环境变量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push -f https://"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${access_token}")]),s._v("@github.com/hejialianghe/hejialianghe.github.io master\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 返回上一层")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("写到这里，"),n("font",{attrs:{color:"red"}},[n("strong",[s._v("我们只需把代码push到master分支就能完成构建与部署")])]),s._v("，可以参考的源码："),n("a",{attrs:{href:"https://github.com/hejialianghe/Senior-FrontEnd.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("源码地址"),n("OutboundLink")],1)],1),s._v(" "),n("h3",{attrs:{id:"_6-1-3-完成blog-youliaowu-com的部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-3-完成blog-youliaowu-com的部署"}},[s._v("#")]),s._v(" 6.1.3 完成blog.youliaowu.com的部署")]),s._v(" "),n("h4",{attrs:{id:"_1-生成公钥和私匙-把公钥拷贝到部署服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-生成公钥和私匙-把公钥拷贝到部署服务器"}},[s._v("#")]),s._v(" 1.生成公钥和私匙，把公钥拷贝到部署服务器")]),s._v(" "),n("p",[s._v("为什么生成公钥和私匙？")]),s._v(" "),n("p",[s._v("因为Travis需要把构建好的代码上传到部署服务器，上传需要验证，所以我们采用ssh"),n("code",[s._v("公钥和私匙")]),s._v("的方式登录部署服务器。")]),s._v(" "),n("p",[s._v("🍅 执行ssh-keygen -t rsa 生成生成公钥和私匙")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" ssh-keygen -t rsa  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在自己的电脑执行此命令，一路按回车即可，window电脑打开bash执行")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("成功后会显示以下信息，id_rsa是私匙，id_rsa.pub是公钥，下面还显示它们所在的路径。")]),s._v(" "),n("p",[s._v("Your identification has been saved in /Users/hejialiang/.ssh/id_rsa")]),s._v(" "),n("p",[s._v("Your public key has been saved in /Users/hejialiang/.ssh/id_rsa.pub")]),s._v(" "),n("p",[s._v("🍅 把公钥拷贝到自己的服务器")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh-copy-id <登录部署服务器用户名>@<部署服务器地址> -p <部署服务器ssh端口>")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果ssh默认端口是22，则不需要 -p")]),s._v("\n ssh-copy-id root@122.51.11.29 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这条命令会把公钥添加到服务器~/.ssh/目录下authorized_keys文件中")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这条命令是登录自己的服务器，如果不需要输入密码，说明你的公钥添加成功，这只是为了验证公钥是否添加成功")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@122.51.11.29 \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("执行上面3条命令我们成功的把公钥添加到了部署服务器，那么下面我们在把私匙添加到Travis中。")]),s._v(" "),n("h4",{attrs:{id:"_2-把私匙添加到travis中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-把私匙添加到travis中"}},[s._v("#")]),s._v(" 2.把私匙添加到Travis中")]),s._v(" "),n("p",[s._v("为了避免私钥泄露，我们还需要对私钥进行加密，这里要用Travis命令行工具进行加密，因为我们的电脑没有Travis命令行工具，所以要进行下载安装，\n下载Travis需要用ruby的包gem，mac电脑内置了ruby，所以不需要下载，其它系统需要先下载最新ruby，我们以mac电脑为例。")]),s._v(" "),n("p",[s._v("上面我们登录了的服务器，现在我们退出服务器，或者在打来一个命令行工具，去执行以下操作")]),s._v(" "),n("p",[s._v("🍅 下载travis")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看镜像源")]),s._v("\ngem sources -l\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加阿里镜像源，删除国外镜像源，为了下载速度更快")]),s._v("\ngem sources --add http://mirrors.aliyun.com/rubygems/ --remove https://rubygems.org/\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载travis")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" gem "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" travis\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("travis下载成功后，我们利用它给私钥加密。")]),s._v(" "),n("p",[s._v("🍅 给私匙加密")]),s._v(" "),n("p",[s._v("我们把路径切换到我们项目的根目录，cd /Users/hejialiang/Desktop/vue/Senior-FrontEnd，当然这是我的目录，切换到自己的\n项目根目录即可，然后执行以下命令,要注意的是项目里根目录要有"),n("code",[s._v(".git")]),s._v("文件，否则会出现问题。")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --auto自动登录github帐号，输入自己的github账号密码即可")]),s._v("\ntravis login --auto\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --add参数可以自动把环境变量写入.travis.yml")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" travis encrypt-file ~/.ssh/id_rsa --add\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("该命令会生成一个环境变量$encrypted_844372f51c48_key，保存密钥，储存在 Travis CI，文件解密时需要这个环境变量。")]),s._v(" "),n("p",[s._v("执行完以后，travis网站项目设置里的环境变量里多了两个参数，并且在.travis.yml里的before_install周期中多了下面这2行，\n还在项目的根目录生成了加密的私钥id_rsa.enc")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("before_install:\n- openssl aes-256-cbc -K "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encrypted_31539db9e051_key")]),s._v(" -iv "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encrypted_31539db9e051_iv")]),s._v("\n  -in id_rsa.enc -out ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("/.ssh/id_rsa -d\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("我们把上面"),n("code",[s._v("~\\/.ssh/id_rsa -d")]),s._v("的转义符"),n("code",[s._v("\\")]),s._v("去掉，我们不需要这个转义符。")]),s._v(" "),n("p",[s._v("🍅 下面是完整的.travis.yml配置")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("language: node_js\nnode_js: \n  - lts/* "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置语言版本，lts表示稳定版")]),s._v("\nbranches:\n  only:\n    - master "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置只监听哪个分支")]),s._v("\ncache:\n  apt: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  yarn: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  directories: \n    - node_modules "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#缓存依赖")]),s._v("\nbefore_install:\n- openssl aes-256-cbc -K "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encrypted_844372f51c48_key")]),s._v(" -iv "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$encrypted_844372f51c48_iv")]),s._v("\n  -in id_rsa.enc -out  ~/.ssh/id_rsa -d "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# id_rsa.enc加密的私钥")]),s._v("\n- "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" ~/.ssh/id_rsa "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 降低 id_rsa 文件的权限")]),s._v("\n- "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Host 122.51.11.29'),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\t"}},[s._v("\\t")]),s._v("StrictHostKeyChecking no"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[s._v("\\n")]),s._v('"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.ssh/config "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将生产服务器地址加入到测试机的信任列表中")]),s._v("\ninstall:  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装依赖")]),s._v("\n  - "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v("\n\nscript:  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 需要执行的脚本")]),s._v("\n    - "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" build\n    - "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" ./deploy.sh\n\naddons:\n  ssh_known_hosts: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("122.51")]),s._v(".11.29 "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加 SSH 信任列表")]),s._v("\nafter_success: "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# script 阶段成功时执行")]),s._v("\n- "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v("  -o "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("stricthostkeychecking")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no -r ./dist/* root@122.51.11.29:/home/www/blog  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用scp拷贝到服务")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("把上面的ip替换成自己的即可，scp是拷贝travis服务器dist目录下所有的资源到部署服务器的/home/www/blog目录下，这个dist目录是你的webpack生成的目录。")]),s._v(" "),n("p",[s._v("接下来把代码push到github就算大功告成！")]),s._v(" "),n("p",[n("font",{attrs:{color:"red"}},[n("strong",[s._v("我们可以travis-ci网站，去查看项目的构建情况，可以看见脚本输出的展示信息。")])])],1),s._v(" "),n("h3",{attrs:{id:"_6-1-4-遇到的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-4-遇到的问题"}},[s._v("#")]),s._v(" 6.1.4 遇到的问题")]),s._v(" "),n("h4",{attrs:{id:"_1-要下载的ruby最新版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-要下载的ruby最新版"}},[s._v("#")]),s._v(" 1.要下载的ruby最新版")]),s._v(" "),n("p",[s._v("我开始准备在linux服务器上去给私钥加密的，在linux服务器下载ruby，我使用的"),n("code",[s._v("sudo yum install ruby")]),s._v("方式下载，给我下载的不是最新版本，\n是"),n("code",[s._v("2.0.0")]),s._v("版本，导致后面出现一系列问题；所以下载要最新版本的，不要使用"),n("code",[s._v("sudo yum install ruby")]),s._v("下载，我的mac上"),n("code",[s._v("2.3.7")]),s._v("版中没有出现问题，\nmac内置ruby哦，所以不需要安装；window上直接下载安装包即可，可能会出现一些问题，有问题直接百度吧，一般都是有答案的。")]),s._v(" "),n("p",[s._v("linux上建议用编译源码的安装方式")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/ruby "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建ruby目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" usr/local/ruby  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.0-preview1.tar.gz "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf ruby-2.7.0-preview1.tar.gz "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ./ruby-2.7.0-preview1\n./configure --prefix"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/ruby "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置并指定安装位置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译安装")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/ruby/bin/ruby /usr/local/bin/ruby "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置全局软链接")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h4",{attrs:{id:"_2-私钥加密生成的环境变量问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-私钥加密生成的环境变量问题"}},[s._v("#")]),s._v(" 2.私钥加密生成的环境变量问题")]),s._v(" "),n("p",[s._v("私钥加密后要去travis网站下看看本项目设置里是否多了2个环境变量，一个是"),n("code",[s._v("$encrypted_31539db9e051_key")]),s._v("和"),n("code",[s._v("$encrypted_31539db9e051_iv")]),s._v("。")]),s._v(" "),n("p",[s._v("我们查看的网站是"),n("code",[s._v("https://www.travis-ci.org/")]),s._v("看而不是com后缀的"),n("code",[s._v("https://travis-ci.com/")]),s._v("，2个网站的变量不能同步，除非在com的网站里导入org里的环境变量。")]),s._v(" "),n("h4",{attrs:{id:"_3-上传到自己的服务器可能出现超时的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-上传到自己的服务器可能出现超时的问题"}},[s._v("#")]),s._v(" 3.上传到自己的服务器可能出现超时的问题")]),s._v(" "),n("p",[s._v("因为travis是国外的网站，上传到国内的服务器可能出现超时现象，可以travis.yml中配置脚本进行压缩后在上传。")]),s._v(" "),n("h3",{attrs:{id:"_6-1-5-总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-5-总结"}},[s._v("#")]),s._v(" 6.1.5 总结")]),s._v(" "),n("p",[s._v("上传到github服务器上其实很简单，关键是上传到自己的服务器会出现一些问题，基本都是安装包的问题，如果出现问题可以和我交流，在本项目的指南介绍中有联系方式，\n看在博主辛苦输出内容， "),n("font",{attrs:{color:"red"}},[n("strong",[s._v("帮我的项目点个star")])]),n("a",{attrs:{href:"https://github.com/hejialianghe/Senior-FrontEnd",target:"_blank",rel:"noopener noreferrer"}},[s._v("源码地址"),n("OutboundLink")],1),s._v("。")],1)])}),[],!1,null,null,null);a.default=e.exports}}]);