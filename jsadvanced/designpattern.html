<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>4.1 设计模式概论 | web全栈体系</title>
    <meta name="description" content="你好，朋友">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.5718d53e.css" as="style"><link rel="preload" href="/assets/js/app.0f616eb6.js" as="script"><link rel="preload" href="/assets/js/3.9750fba5.js" as="script"><link rel="preload" href="/assets/js/2.6aa46093.js" as="script"><link rel="preload" href="/assets/js/97.c2372908.js" as="script"><link rel="prefetch" href="/assets/js/10.3b417cc7.js"><link rel="prefetch" href="/assets/js/100.450b51bc.js"><link rel="prefetch" href="/assets/js/101.02365136.js"><link rel="prefetch" href="/assets/js/102.23f6118f.js"><link rel="prefetch" href="/assets/js/103.4decf838.js"><link rel="prefetch" href="/assets/js/104.d39cfd73.js"><link rel="prefetch" href="/assets/js/105.88534338.js"><link rel="prefetch" href="/assets/js/106.366d0b59.js"><link rel="prefetch" href="/assets/js/107.cf3cfcba.js"><link rel="prefetch" href="/assets/js/108.21694919.js"><link rel="prefetch" href="/assets/js/109.4e4fd62e.js"><link rel="prefetch" href="/assets/js/11.9d20f01b.js"><link rel="prefetch" href="/assets/js/110.aeb394e4.js"><link rel="prefetch" href="/assets/js/111.d6595775.js"><link rel="prefetch" href="/assets/js/12.ac6dcc46.js"><link rel="prefetch" href="/assets/js/13.3990b71a.js"><link rel="prefetch" href="/assets/js/14.42418305.js"><link rel="prefetch" href="/assets/js/15.3e7fea41.js"><link rel="prefetch" href="/assets/js/16.e9242241.js"><link rel="prefetch" href="/assets/js/17.5cb2a82b.js"><link rel="prefetch" href="/assets/js/18.09a2ee08.js"><link rel="prefetch" href="/assets/js/19.5e018236.js"><link rel="prefetch" href="/assets/js/20.2f6aad81.js"><link rel="prefetch" href="/assets/js/21.56a0a87d.js"><link rel="prefetch" href="/assets/js/22.37a8fef4.js"><link rel="prefetch" href="/assets/js/23.75c65558.js"><link rel="prefetch" href="/assets/js/24.19255d9b.js"><link rel="prefetch" href="/assets/js/25.b96e970c.js"><link rel="prefetch" href="/assets/js/26.8043101d.js"><link rel="prefetch" href="/assets/js/27.c05d3044.js"><link rel="prefetch" href="/assets/js/28.c0aa90a2.js"><link rel="prefetch" href="/assets/js/29.06c0191d.js"><link rel="prefetch" href="/assets/js/30.975fb305.js"><link rel="prefetch" href="/assets/js/31.0cba5310.js"><link rel="prefetch" href="/assets/js/32.d8bc188f.js"><link rel="prefetch" href="/assets/js/33.384f6578.js"><link rel="prefetch" href="/assets/js/34.6baca6a7.js"><link rel="prefetch" href="/assets/js/35.96ec3f3e.js"><link rel="prefetch" href="/assets/js/36.bd945c36.js"><link rel="prefetch" href="/assets/js/37.be27655b.js"><link rel="prefetch" href="/assets/js/38.e8e93b37.js"><link rel="prefetch" href="/assets/js/39.ef88fac1.js"><link rel="prefetch" href="/assets/js/4.aa28cc69.js"><link rel="prefetch" href="/assets/js/40.b6dad60d.js"><link rel="prefetch" href="/assets/js/41.c762ef5a.js"><link rel="prefetch" href="/assets/js/42.151d8a58.js"><link rel="prefetch" href="/assets/js/43.632c642f.js"><link rel="prefetch" href="/assets/js/44.2e34b5d9.js"><link rel="prefetch" href="/assets/js/45.94f8db29.js"><link rel="prefetch" href="/assets/js/46.57527f8f.js"><link rel="prefetch" href="/assets/js/47.44a84132.js"><link rel="prefetch" href="/assets/js/48.66958018.js"><link rel="prefetch" href="/assets/js/49.21739b30.js"><link rel="prefetch" href="/assets/js/5.e06ff02e.js"><link rel="prefetch" href="/assets/js/50.000c5d7c.js"><link rel="prefetch" href="/assets/js/51.b59a6470.js"><link rel="prefetch" href="/assets/js/52.3a475ad4.js"><link rel="prefetch" href="/assets/js/53.9801890b.js"><link rel="prefetch" href="/assets/js/54.269a45cd.js"><link rel="prefetch" href="/assets/js/55.91e89997.js"><link rel="prefetch" href="/assets/js/56.493b7ae8.js"><link rel="prefetch" href="/assets/js/57.ec46c27c.js"><link rel="prefetch" href="/assets/js/58.56202f8d.js"><link rel="prefetch" href="/assets/js/59.4dac8d8a.js"><link rel="prefetch" href="/assets/js/6.45a79ebc.js"><link rel="prefetch" href="/assets/js/60.77f7cd1f.js"><link rel="prefetch" href="/assets/js/61.a48bae63.js"><link rel="prefetch" href="/assets/js/62.626e88b6.js"><link rel="prefetch" href="/assets/js/63.9d36ed5d.js"><link rel="prefetch" href="/assets/js/64.a6a4e5c6.js"><link rel="prefetch" href="/assets/js/65.e32c3a18.js"><link rel="prefetch" href="/assets/js/66.0de20cc0.js"><link rel="prefetch" href="/assets/js/67.b24d4adf.js"><link rel="prefetch" href="/assets/js/68.7269173e.js"><link rel="prefetch" href="/assets/js/69.9999d01e.js"><link rel="prefetch" href="/assets/js/7.1a1f32a2.js"><link rel="prefetch" href="/assets/js/70.a45e1785.js"><link rel="prefetch" href="/assets/js/71.d443735d.js"><link rel="prefetch" href="/assets/js/72.56bd9ca0.js"><link rel="prefetch" href="/assets/js/73.4a484020.js"><link rel="prefetch" href="/assets/js/74.d0f77ba8.js"><link rel="prefetch" href="/assets/js/75.8595de75.js"><link rel="prefetch" href="/assets/js/76.b89309e6.js"><link rel="prefetch" href="/assets/js/77.1a28c952.js"><link rel="prefetch" href="/assets/js/78.156340fe.js"><link rel="prefetch" href="/assets/js/79.bc68f887.js"><link rel="prefetch" href="/assets/js/8.ffcc6d32.js"><link rel="prefetch" href="/assets/js/80.00742412.js"><link rel="prefetch" href="/assets/js/81.d07bf30f.js"><link rel="prefetch" href="/assets/js/82.dd648b4e.js"><link rel="prefetch" href="/assets/js/83.50310bd1.js"><link rel="prefetch" href="/assets/js/84.8b446b87.js"><link rel="prefetch" href="/assets/js/85.1bbf1222.js"><link rel="prefetch" href="/assets/js/86.b1112682.js"><link rel="prefetch" href="/assets/js/87.5353ad37.js"><link rel="prefetch" href="/assets/js/88.3bc7938a.js"><link rel="prefetch" href="/assets/js/89.c9d6877e.js"><link rel="prefetch" href="/assets/js/9.bfaf9c10.js"><link rel="prefetch" href="/assets/js/90.f7c20556.js"><link rel="prefetch" href="/assets/js/91.72437dd2.js"><link rel="prefetch" href="/assets/js/92.2a17869e.js"><link rel="prefetch" href="/assets/js/93.cc33ea11.js"><link rel="prefetch" href="/assets/js/94.49e5d122.js"><link rel="prefetch" href="/assets/js/95.9c954379.js"><link rel="prefetch" href="/assets/js/96.638e1dee.js"><link rel="prefetch" href="/assets/js/98.762254ac.js"><link rel="prefetch" href="/assets/js/99.29af3121.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5718d53e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-266a5a28><header class="navbar" data-v-266a5a28><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="web全栈体系" class="logo"> <span class="site-name can-hide">web全栈体系</span></a> <div class="carousel" data-v-1a4d21d9></div> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><a href="https://github.com/hejialianghe" class="repo-star"><img src="https://img.shields.io/github/stars/hejialianghe/Senior-FrontEnd.svg?style=flat-square" alt></a> <div class="nav-item"><a href="/algorithm/complexity.html" class="nav-link">算法小册</a></div><div class="nav-item"><a href="/guide/" class="nav-link">web体系</a></div><div class="nav-item"><a href="/fp/react/build-react.html" class="nav-link">框架原理</a></div><div class="nav-item"><a href="https://github.com/hejialianghe/Senior-FrontEnd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitee.com/hejialianghe/Senior-FrontEnd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jsadvanced/designpattern.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en-US/jsadvanced/designpattern.html" class="nav-link">English</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-266a5a28></div> <aside class="sidebar" data-v-266a5a28><nav class="nav-links"><a href="https://github.com/hejialianghe" class="repo-star"><img src="https://img.shields.io/github/stars/hejialianghe/Senior-FrontEnd.svg?style=flat-square" alt></a> <div class="nav-item"><a href="/algorithm/complexity.html" class="nav-link">算法小册</a></div><div class="nav-item"><a href="/guide/" class="nav-link">web体系</a></div><div class="nav-item"><a href="/fp/react/build-react.html" class="nav-link">框架原理</a></div><div class="nav-item"><a href="https://github.com/hejialianghe/Senior-FrontEnd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitee.com/hejialianghe/Senior-FrontEnd" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jsadvanced/designpattern.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/en-US/jsadvanced/designpattern.html" class="nav-link">English</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" class="sidebar-link">介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JavaScript进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jsadvanced/" aria-current="page" class="sidebar-link">前言</a></li><li><a href="/jsadvanced/function.html" class="sidebar-link">函数</a></li><li><a href="/jsadvanced/asyncpro.html" class="sidebar-link">异步编程</a></li><li><a href="/jsadvanced/designpattern.html" aria-current="page" class="active sidebar-link">设计模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-1-设计模式概论" class="sidebar-link">4.1 设计模式概论</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-1-1-代码与设计模式" class="sidebar-link">4.1.1 代码与设计模式</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-1-2-设计模式的分类" class="sidebar-link">4.1.2 设计模式的分类</a></li></ul></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-2-封装对象" class="sidebar-link">4.2 封装对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-2-1-封装对象时的设计模式" class="sidebar-link">4.2.1 封装对象时的设计模式</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-2-2-基本结构" class="sidebar-link">4.2.2 基本结构</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-2-3-应用示例" class="sidebar-link">4.2.3 应用示例</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-2-4-总结" class="sidebar-link">4.2.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-3-提高复用性" class="sidebar-link">4.3 提高复用性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-3-1-提高复用性的设计模式" class="sidebar-link">4.3.1 提高复用性的设计模式</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-3-2-基本结构" class="sidebar-link">4.3.2 基本结构</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-3-3-应用示例" class="sidebar-link">4.3.3 应用示例</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-3-4-总结" class="sidebar-link">4.3.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-4-提高可扩展性-1" class="sidebar-link">4.4 提高可扩展性（1）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-4-1-提高可扩展性的设计模式" class="sidebar-link">4.4.1 提高可扩展性的设计模式</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-4-2-基本结构" class="sidebar-link">4.4.2 基本结构</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-4-3-应用示例" class="sidebar-link">4.4.3 应用示例</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-4-4-总结" class="sidebar-link">4.4.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-5-提高可扩展性-2" class="sidebar-link">4.5 提高可扩展性（2）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-5-1-提高可扩展性的设计模式" class="sidebar-link">4.5.1 提高可扩展性的设计模式</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-5-2-基本结构" class="sidebar-link">4.5.2 基本结构</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-5-3-应用示例" class="sidebar-link">4.5.3 应用示例</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-5-4-总结" class="sidebar-link">4.5.4 总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-6-提高代码质量" class="sidebar-link">4.6 提高代码质量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-6-1-优化代码结构" class="sidebar-link">4.6.1 优化代码结构</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-6-2-优化你的代码操作" class="sidebar-link">4.6.2 优化你的代码操作</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-6-3-基本结构" class="sidebar-link">4.6.3 基本结构</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-6-4-应用示例" class="sidebar-link">4.6.4 应用示例</a></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-6-5-本章总结" class="sidebar-link">4.6.5 本章总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/jsadvanced/designpattern.html#_4-7-总结" class="sidebar-link">4.7 总结</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>计算机网络</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/computerNetwork/protocal.html" class="sidebar-link">网络协议</a></li><li><a href="/computerNetwork/network-actual.html" class="sidebar-link">网络请求实战</a></li><li><a href="/computerNetwork/security.html" class="sidebar-link">网络安全与攻防</a></li><li><a href="/computerNetwork/browser-status.html" class="sidebar-link">浏览器状态同步和路由</a></li><li><a href="/computerNetwork/tools.html" class="sidebar-link">工具链和其他</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/" class="sidebar-link">前言</a></li><li><a href="/vue/vueBase.html" class="sidebar-link">vue基础</a></li><li><a href="/vue/vueComponents.html" class="sidebar-link">探索vue的组件世界</a></li><li><a href="/vue/sourceCode.html" class="sidebar-link">部分源码解析</a></li><li><a href="/vue/serverSideRender.html" class="sidebar-link">服务端渲染</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>react</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/" class="sidebar-link">入门介绍</a></li><li><a href="/react/react-base.html" class="sidebar-link">步入react</a></li><li><a href="/react/react-positive.html" class="sidebar-link">react正篇</a></li><li><a href="/react/react-ecology.html" class="sidebar-link">react生态</a></li><li><a href="/react/react-principle.html" class="sidebar-link">react原理</a></li><li><a href="/react/react-state-mana.html" class="sidebar-link">react状态管理</a></li><li><a href="/react/react-actualCombat.html" class="sidebar-link">react高级实战</a></li><li><a href="/react/react-hooks.html" class="sidebar-link">react-hooks</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Node.js进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/node/" class="sidebar-link">Node.js基础</a></li><li><a href="/node/koa.html" class="sidebar-link">koa</a></li><li><a href="/node/egg.html" class="sidebar-link">企业级框架egg</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/engineering/script.html" class="sidebar-link">脚本世界</a></li><li><a href="/engineering/coding-standards.html" class="sidebar-link">规范先行</a></li><li><a href="/engineering/quality-code.html" class="sidebar-link">质量代码</a></li><li><a href="/engineering/design.html" class="sidebar-link">工程设计</a></li><li><a href="/engineering/ctg-art.html" class="sidebar-link">构建艺术</a></li><li><a href="/engineering/auto-deploy.html" class="sidebar-link">持续集成与部署</a></li><li><a href="/engineering/git.html" class="sidebar-link">Git操作</a></li><li><a href="/engineering/tool.html" class="sidebar-link">效率工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>小程序</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/applets/performance.html" class="sidebar-link">小程序进阶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>项目实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/projectPractice/isomorphism.html" class="sidebar-link">认识同构及原理</a></li><li><a href="/projectPractice/demo.html" class="sidebar-link">实现一个同构的demo</a></li><li><a href="/projectPractice/nextjs.html" class="sidebar-link">Nextjs</a></li></ul></section></li></ul> </aside> <main class="page" data-v-266a5a28> <div class="ads" data-v-a4c8d602><div class="item" data-v-a4c8d602><h6 class="title" style="display:;" data-v-a4c8d602>联系作者</h6> <div class="thumb" data-v-a4c8d602><a href="/weixin.jpeg" target="_blank" data-v-a4c8d602><img src="/weixin.jpeg" alt="联系作者" data-v-a4c8d602></a></div></div></div> <div class="theme-default-content content__default"><h2 id="_4-1-设计模式概论"><a href="#_4-1-设计模式概论" class="header-anchor">#</a> 4.1 设计模式概论</h2> <h3 id="_4-1-1-代码与设计模式"><a href="#_4-1-1-代码与设计模式" class="header-anchor">#</a> 4.1.1 代码与设计模式</h3> <h4 id="我们写代码到底是在写什么"><a href="#我们写代码到底是在写什么" class="header-anchor">#</a> 🍅 我们写代码到底是在写什么？</h4> <p>我们写项目其实就是写模块然后设计它们之间的沟通，设计模式说白了就是帮助我们更好的设计模块，
更好的组织它们之间的沟通。</p> <h4 id="设计模式扮演的角色"><a href="#设计模式扮演的角色" class="header-anchor">#</a> 🍅 设计模式扮演的角色</h4> <ul><li><p>帮助我们组织模块</p> <p>通过一些设计模式，组织模块间的组成结构</p></li> <li><p>帮助我们设计沟通</p> <p>有的设计模式可以帮助我们设计模块间如何沟通</p></li> <li><p>提高代码质量</p> <p>通过设计模式，让代码更加优雅</p></li></ul> <h4 id="设计原则"><a href="#设计原则" class="header-anchor">#</a> 🍅 设计原则</h4> <ol><li><p>开闭原则</p> <p>我们的程序要对扩展开放，对修改关闭；我们的程序要给具体使用的时候扩展的接口，但是在具体使用的时候不能让其修改我们的源码，
也就是说我们不用修改源码就能扩展功能，像 vue，react 等都有扩展的接口。</p></li> <li><p>单一职责原则</p> <p>我们的模块只做一件事情，模块的职责越单一越好。</p></li> <li><p>依赖倒置原则</p> <p>我们的上层模块不要依赖与具体的下层模块，应该依赖于抽象</p></li></ol> <p>假如下面是一套点餐系统，我们在上层和下层之间加一个抽象层；下层如何变动都不会影响到上层，只需更改抽象层即可。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 具体层</span>
<span class="token keyword">function</span> <span class="token function">Food1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Food2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Food3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 抽象层</span>
<span class="token keyword">function</span> <span class="token function">resturn</span><span class="token punctuation">(</span><span class="token parameter">food</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token punctuation">{</span>
    food1<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Food1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    food2<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Food2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    food3<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Food3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> list<span class="token punctuation">[</span>food<span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 上层</span>
<span class="token keyword">function</span> <span class="token function">order</span><span class="token punctuation">(</span><span class="token parameter">food</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">resturn</span><span class="token punctuation">(</span>food<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ol start="4"><li>接口隔离原则</li></ol> <p>我们的接口要细化，功能要单一，一个接口不要调用太多方法，使其能力单一，听起来像单一职责原则；但是 2 者的关注点不同，
单一职责原则主要关注于模块本身，接口隔离原则关注于接口；我们尽量细化接口，每个接口做的事情尽量单一化；接口隔离原则的核心思想就是 拆分职责单一的接口，避免不必要的依赖。</p> <ol start="5"><li>迪米特法则</li></ol> <p>我们让 2 个对象之间产生沟通，我们最好让 2 个对象之间知道的越少越好，没必要 2 者之间非常的了解；我们的中介者模式是一个很好体现迪米特法则的设计模式，中介者模式让 2 个对象之间没必要直接的沟通，如果直接沟通需要了解 2 者之间的 api 和彼此的调用方式，这个时候我们可以采用一个中介者来转达我们的需求，而不用彼此知道</p> <ol start="6"><li>里氏替换原则</li></ol> <p>它主要关注于继承，它的意义是任何使用父类的地方都可以用子类去替换，直白的说我们子类继承父类的时候，我们的子类必须完全保证继承父类的属性和方法，这样的话父类使用的地方，子类可以进行替换</p> <p><font color="red"><strong>后面学习到设计模式都是在体现这些设计原则</strong></font></p> <h3 id="_4-1-2-设计模式的分类"><a href="#_4-1-2-设计模式的分类" class="header-anchor">#</a> 4.1.2 设计模式的分类</h3> <ol><li>创建型</li></ol> <p>这些设计模式可以帮助我们优雅地创建对象</p> <ol start="2"><li>结构型</li></ol> <p>帮助我们优雅地设计代码结构</p> <ol start="3"><li>行为型</li></ol> <p>模块之间行为的模式总结，帮助我们组织模块行为</p> <ol start="4"><li>技巧型</li></ol> <p>一些帮助我们优化代码的技巧</p> <h4 id="创建型"><a href="#创建型" class="header-anchor">#</a> 🍅 创建型</h4> <ul><li><p>工厂模式-大量创建对象</p></li> <li><p>单例模式-全局只能有我一个</p></li> <li><p>建造者模式-精细化组合对象</p></li> <li><p>原型模式-javaScript 的灵魂</p></li></ul> <h4 id="结构型"><a href="#结构型" class="header-anchor">#</a> 🍅 结构型</h4> <ul><li><p>外观模式-给你的一个套餐</p></li> <li><p>适配器模式-用适配代替更改</p></li> <li><p>装饰者模式-更优雅地扩展需求</p></li> <li><p>享元模式-共享来减少数量</p></li> <li><p>桥接模式-独立出来，然后再对接过去</p></li></ul> <h4 id="行为型"><a href="#行为型" class="header-anchor">#</a> 🍅 行为型</h4> <ul><li><p>观察者模式-我作为第三方转发</p></li> <li><p>状态模式-用状态代替判断</p></li> <li><p>策略模式-算法工厂</p></li> <li><p>职责链模式-像生产线一样组织模块</p></li> <li><p>命令模式-用命令去解耦</p></li> <li><p>迭代器模式-告别 for 循环</p></li></ul> <h4 id="技巧模式"><a href="#技巧模式" class="header-anchor">#</a> 🍅 技巧模式</h4> <ul><li><p>链模式-链式调用</p></li> <li><p>委托模式-让别人代替你收快递</p></li> <li><p>数据访问模式-一个方便的数据管理器</p></li> <li><p>惰性模式-我要搞机器学习（第一次执行完后把状态记录下来）</p></li> <li><p>等待者模式-等你们都回来再吃饭</p></li></ul> <h2 id="_4-2-封装对象"><a href="#_4-2-封装对象" class="header-anchor">#</a> 4.2 封装对象</h2> <p>创建型设计模式到底是怎么样使用的，利用创建型设计模式更好的封装代码更好的创建对象</p> <p>封装的目的？</p> <ul><li><p>定义的变量不会污染到外部</p></li> <li><p>能够作为一个模块调用</p></li> <li><p>遵循开闭原则</p></li></ul> <p>什么是好的封装？</p> <ul><li><p>变量外部不可见</p></li> <li><p>调用接口使用</p></li> <li><p>留出扩展接口</p></li></ul> <h3 id="_4-2-1-封装对象时的设计模式"><a href="#_4-2-1-封装对象时的设计模式" class="header-anchor">#</a> 4.2.1 封装对象时的设计模式</h3> <h4 id="创建一个对象的模式"><a href="#创建一个对象的模式" class="header-anchor">#</a> 🍅 创建一个对象的模式</h4> <ul><li><p>工厂模式</p> <p>目的：方便我们大量创建对象</p> <p>应用场景：当某一个对象需要经常创建的时候</p></li> <li><p>建造者模式</p> <p>目的：需要组合出一个全局对象</p> <p>应用场景：当要创建单个、庞大的组合对象时</p></li></ul> <h4 id="保障对象全局只有一个"><a href="#保障对象全局只有一个" class="header-anchor">#</a> 🍅 保障对象全局只有一个</h4> <ul><li><p>单例模式</p> <p>目的：需要确保全局只有一个对象</p> <p>应用场景：为了避免重复新建，避免多个对象存在相互干扰</p></li></ul> <h3 id="_4-2-2-基本结构"><a href="#_4-2-2-基本结构" class="header-anchor">#</a> 4.2.2 基本结构</h3> <h4 id="工厂模式的基本结构"><a href="#工厂模式的基本结构" class="header-anchor">#</a> 🍅 工厂模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Factory</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'type1'</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Type1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token string">'type2'</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Type2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token string">'type3'</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Type3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>工厂模式就是写一个方法，只需调用这个方法，就能拿到你要的对象</p> <h4 id="建造者模式的基本结构"><a href="#建造者模式的基本结构" class="header-anchor">#</a> 🍅 建造者模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//  模块1</span>
<span class="token keyword">function</span> <span class="token function">Mode1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 模块2</span>
<span class="token keyword">function</span> <span class="token function">Mode2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 最终使用的类</span>
<span class="token keyword">function</span> <span class="token function">Final</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>mode1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>mode2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mode2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>把一个复杂的类各个部分，拆分成独立的类，然后再最终类里组合到一块，final 为最终给出去的类</p> <h4 id="单例模式的基本结构"><a href="#单例模式的基本结构" class="header-anchor">#</a> 🍅 单例模式的基本结构</h4> <p>单例模式的做法不是很固定，我们更重要的记住是保证全局只有一个对象的思想</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 作为单例实例化的对象</span>
<span class="token keyword">let</span> <span class="token function-variable function">SingLeton</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token comment">/*
在SingLeton挂在一个getInstance方法，只能通过getInstance方法来获取
SingLeton的实力化对象
*/</span>
SingLeton<span class="token punctuation">.</span><span class="token function-variable function">getInstance</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingLeton</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>通过定义一个方法，使用时只允许通过此方法拿到存在内部的同一实例化对象</p> <h3 id="_4-2-3-应用示例"><a href="#_4-2-3-应用示例" class="header-anchor">#</a> 4.2.3 应用示例</h3> <h4 id="工厂模式的示例"><a href="#工厂模式的示例" class="header-anchor">#</a> 🍅 工厂模式的示例</h4> <p>实现一个多彩的弹窗？</p> <p>需求：弹窗有多种，它们之间存在内容和颜色上的差异</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">ROOT</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 消息弹性</span>
  <span class="token keyword">function</span> <span class="token function">infoPop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 确认弹窗</span>
  <span class="token keyword">function</span> <span class="token function">confirmPop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 取消弹窗</span>
  <span class="token keyword">function</span> <span class="token function">cancelPop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// 弹窗工厂</span>
  <span class="token keyword">function</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> content<span class="token punctuation">,</span> color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'infoPop'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">infoPop</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> color<span class="token punctuation">)</span>
      <span class="token keyword">case</span> <span class="token string">'confirmPop'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">confirmPop</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> color<span class="token punctuation">)</span>
      <span class="token keyword">case</span> <span class="token string">'confircancelPopmPop'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">cancelPop</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> color<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token constant">ROOT</span><span class="token punctuation">.</span>pop <span class="token operator">=</span> pop
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
<span class="token comment">// 根据传入不同的参数来，来弹出不同的弹窗</span>
<span class="token function">pop</span><span class="token punctuation">(</span><span class="token string">'infoPop'</span><span class="token punctuation">,</span> <span class="token string">'开始'</span><span class="token punctuation">,</span> <span class="token string">'white'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>上面这种写法有个弊端就是不能 new pop，当用户用 new 关键词就不适用了</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">ROOT</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> content<span class="token punctuation">,</span> color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">pop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> color<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">pop</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> content<span class="token punctuation">,</span> color<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  pop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">infoPop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  pop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">confirmPop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  pop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">cancelPop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token constant">ROOT</span><span class="token punctuation">.</span>pop <span class="token operator">=</span> pop
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>

<span class="token function">pop</span><span class="token punctuation">(</span><span class="token string">'infoPop'</span><span class="token punctuation">,</span> <span class="token string">'开始'</span><span class="token punctuation">,</span> <span class="token string">'white'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>jQuery 源码示例</p> <p>需求：jQuery 需要操作 dom，每个 dom 都是一个 jq 对象</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">/*
 seletor 选择器
 context 上下文
*/</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">ROOT</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token function-variable function">jQuery</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//之所以不new jQuery本身，避免递归造成无限循环，我们用的Query.fn上的init方法代替</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>seletor<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// JQuery各种操作都会挂载到prototype上</span>
  JQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token class-name">JQuery</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init<span class="token punctuation">.</span>prototype <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn
  <span class="token comment">// extend方法把方法拷贝extend对象上</span>
  jQuery<span class="token punctuation">.</span>extend <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">extend</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  jQuery<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token constant">ROOT</span><span class="token punctuation">.</span>$ <span class="token operator">=</span> <span class="token constant">ROOT</span><span class="token punctuation">.</span>jQuery <span class="token operator">=</span> jQuery
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>总结：工厂模式就是要把我们要暴露的对象，真正要实例化的对象先封装到函数的内部，然后我们只暴露一个工厂方法，使用者通过这个工厂方法
来获取我们实例话的对象，它的优势方便我们大量的创建对象。</p> <h4 id="建造者模式的示例"><a href="#建造者模式的示例" class="header-anchor">#</a> 🍅 建造者模式的示例</h4> <p>编写一个编辑器插件</p> <p>需求：有一个编辑器插件，初始化的时候需要配置大量参数，而且内部功能很多</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 最终类</span>
<span class="token keyword">function</span> <span class="token function">Editor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>intt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">initHTML</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fontControll <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">fontControll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>stateControll <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">stateControll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化html的类，最终渲染成dom</span>
<span class="token keyword">function</span> <span class="token function">initHTML</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 初始化控制样式的方法</span>
initHTML<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">initStyle</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 初始化渲染成dom的方法</span>
initHTML<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">renderDom</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 改变字体颜色大小的类</span>
<span class="token keyword">function</span> <span class="token function">fontControll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 控制颜色的方法</span>
fontControll<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">changeColor</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 控制字体大小的方法</span>
fontControll<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">changeFontsize</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 改变状态类，为了前进后退</span>
<span class="token keyword">function</span> <span class="token function">stateControll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//存储状态</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nowstate <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">//状态指针</span>
<span class="token punctuation">}</span>
<span class="token comment">//保存状态的方法</span>
stateControll<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">saveState</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//回滚状态的方法</span>
stateControll<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">saveBack</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowstate <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fontControll<span class="token punctuation">.</span><span class="token function">changeColor</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>color<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fontControll<span class="token punctuation">.</span><span class="token function">changeFontsize</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>color<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//前进状态的方法</span>
stateControll<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">saveGo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

window<span class="token punctuation">.</span>Editor <span class="token operator">=</span> Editor
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>建造者模式是把它的模块抽离出独立的类，然后在组合起来</p> <p>vue 初始化</p> <p>需求：vue 内部众多模块，而且过程复杂，vue 类也可以看做是一个建造者模式</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Vue</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 只允许用户用new操作符，如果直接调用就抛出警告</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Vue</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Vue is a constructor and should be called with the `new` keyword'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 初始化配置项</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

initMixin（Vue<span class="token punctuation">)</span> <span class="token comment">// 初始化系统混入到Vue中去</span>
<span class="token function">stateMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span> <span class="token comment">// 状态系统混入到Vue中去</span>
<span class="token function">eventsMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span> <span class="token comment">// 事件系统的混入</span>
<span class="token function">lifecycleMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span> <span class="token comment">// 生命周期混入</span>
<span class="token function">renderMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span>  <span class="token comment">// 渲染混入</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>通过这些方法和我们上一个案例把模块独立成一个类，把这些类放到暴露出的类里面是一个道理；
只不过这里改成方法，vue 中所有的功能都是独立开发，通过这一系列的混入将其混入进去</p> <h4 id="单例模式的示例"><a href="#单例模式的示例" class="header-anchor">#</a> 🍅 单例模式的示例</h4> <p>写一个数据存储对象</p> <p>需求：项目中有一个全局的数据存储者，这个存储者只能有一个 ，不然会需要进行同步，增加复杂度</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>store<span class="token punctuation">.</span>install<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> store<span class="token punctuation">.</span>install
  <span class="token punctuation">}</span>
  store<span class="token punctuation">.</span>install <span class="token operator">=</span> <span class="token keyword">this</span>
<span class="token punctuation">}</span>

store<span class="token punctuation">.</span>install <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">store</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span>state<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token comment">// store { state: { a: 1 } } store { state: { a: 1 } }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>vue-router</p> <p>需求：vue-router 必须 保障全局有且只有一个，否则的话会错乱</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> _Vue
<span class="token keyword">function</span> <span class="token function">install</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>install<span class="token punctuation">.</span>installed <span class="token operator">&amp;&amp;</span> _Vue <span class="token operator">===</span> vue<span class="token punctuation">)</span> <span class="token keyword">return</span>
  install<span class="token punctuation">.</span>installed <span class="token operator">=</span> <span class="token boolean">true</span>
  _Vue <span class="token operator">=</span> vue
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_4-2-4-总结"><a href="#_4-2-4-总结" class="header-anchor">#</a> 4.2.4 总结</h3> <p>工厂模式：如果你写的模块，需要大量创建类似的对象</p> <p>建造者模式：需要创建一个需要大量参数，且内部模块庞大</p> <p>单例模式：防止重复注册，防止有多个对象互相干扰</p> <h2 id="_4-3-提高复用性"><a href="#_4-3-提高复用性" class="header-anchor">#</a> 4.3 提高复用性</h2> <p>什么是好的复用？</p> <ul><li>对象可以再重复使用，不用修改</li> <li>重复代码少</li> <li>模块功能单一</li></ul> <h3 id="_4-3-1-提高复用性的设计模式"><a href="#_4-3-1-提高复用性的设计模式" class="header-anchor">#</a> 4.3.1 提高复用性的设计模式</h3> <h4 id="减少代码数量-高效复用代码"><a href="#减少代码数量-高效复用代码" class="header-anchor">#</a> 🍅 减少代码数量，高效复用代码</h4> <ul><li><p>桥接模式</p> <p>目的：通过桥接代替耦合</p> <p>应用场景：减少模块之间的耦合</p></li> <li><p>享元模式</p> <p>目的：减少对象/代码数量</p> <p>应用场景：当代码中创建了大量类似对象和类似的代码块</p></li></ul> <h4 id="创建高可复用性的代码"><a href="#创建高可复用性的代码" class="header-anchor">#</a> 🍅 创建高可复用性的代码</h4> <ul><li><p>模版方法模式</p> <p>目的：定义一系列操作的骨架，简化后面类似操作的内容</p> <p>应用场景：当项目中出现很多类似操作内容</p></li></ul> <h3 id="_4-3-2-基本结构"><a href="#_4-3-2-基本结构" class="header-anchor">#</a> 4.3.2 基本结构</h3> <h4 id="桥接模式"><a href="#桥接模式" class="header-anchor">#</a> 🍅 桥接模式</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 有三种形状，每种形状都有3种颜色</span>
<span class="token keyword">function</span> <span class="token function">rect</span><span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//矩形</span>
  <span class="token function">showcolor</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 圆形</span>
  <span class="token function">showcolor</span><span class="token punctuation">(</span>clor<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">delta</span><span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 三角形</span>
  <span class="token function">showcolor</span><span class="token punctuation">(</span>clor<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">circle</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>对于 3 种形状、每种形状有 3 种颜色的需求，可以不用创建 9 种不同颜色的不同形状</li> <li>这个模式把重复的方法抽取出来，然后在桥接出去</li></ul> <p>这个模式跟我们的建造者模式很类似拆分再组合，建造者模式的核心是如何去构造对象；而我们桥接模式是如何简化我们的代码，提高我们的可复用性，一个关注的是功能一个关注的是创建，这是它们的区别。</p> <h4 id="享元模式"><a href="#享元模式" class="header-anchor">#</a> 🍅 享元模式</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token comment">// 有一百种不同文字的弹窗，每种弹窗行为相同，但是文字和样式不同，我们没必要新间一百个弹窗对象</span>
    <span class="token keyword">function</span> <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 保留同样的行为</span>
    <span class="token class-name">Pop</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">action</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">//显示</span>
    <span class="token class-name">Pop</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">show</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 提取出每个弹窗不同的部分作为一个外部数组</span>
    <span class="token keyword">var</span> popArr<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>text<span class="token operator">:</span><span class="token string">&quot;window1&quot;</span><span class="token punctuation">,</span>style<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span>text<span class="token operator">:</span><span class="token string">&quot;window2&quot;</span><span class="token punctuation">,</span>style<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span>

    <span class="token keyword">var</span> poper<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        poper<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>popArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>只需一个类，不需要 new 一百次弹窗</li> <li>这个类只保留所有弹窗共有的，每个弹窗不同的部分留作为一个公共享元</li></ul> <h4 id="模版方法模式"><a href="#模版方法模式" class="header-anchor">#</a> 🍅 模版方法模式</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 编写导航组件，有的带消息提示，有的竖着，有的横者</span>
<span class="token keyword">function</span> <span class="token function">baseNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 基础类，此处定下基本骨架</span>
<span class="token punctuation">}</span>

baseNav<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">action</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 特异性的处理，留一个回调等待具体实现</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>导航组件多种多样，可能后面还会新增类型，那么我们不妨写一个基础的组件库，然后具体的实现，延迟到具体的使用时</li></ul> <h3 id="_4-3-3-应用示例"><a href="#_4-3-3-应用示例" class="header-anchor">#</a> 4.3.3 应用示例</h3> <h4 id="桥接模式的示例"><a href="#桥接模式的示例" class="header-anchor">#</a> 🍅 桥接模式的示例</h4> <p>创建不同的选中效果</p> <p>需求：有一组菜单，上面每种选项都有不同的选中效果</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//  一般做法</span>
<span class="token comment">//menu1,menu2,menu3</span>
<span class="token keyword">function</span> <span class="token function">menuItem</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>word <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>word
<span class="token punctuation">}</span>
<span class="token keyword">var</span> menu1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">menuItem</span><span class="token punctuation">(</span><span class="token string">'menu1'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> menu2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">menuItem</span><span class="token punctuation">(</span><span class="token string">'menu2'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> menu3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">menuItem</span><span class="token punctuation">(</span><span class="token string">'menu3'</span><span class="token punctuation">)</span>
menu1<span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  menu1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
<span class="token punctuation">}</span>
menu2<span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  menu1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'green'</span>
<span class="token punctuation">}</span>
menu3<span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  menu1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'blue'</span>
<span class="token punctuation">}</span>
menu1<span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  menu1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'white'</span>
<span class="token punctuation">}</span>
menu2<span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  menu1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'white'</span>
<span class="token punctuation">}</span>
menu3<span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  menu1<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'white'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 桥接模式做法</span>
<span class="token keyword">function</span> <span class="token function">menuItem</span><span class="token punctuation">(</span><span class="token parameter">word<span class="token punctuation">,</span> color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>word <span class="token operator">=</span> word
  <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> color
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>word
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

menuItem<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span><span class="token function-variable function">onmouseover</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>color<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> self<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorOver
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span><span class="token function-variable function">onmouseout</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> self<span class="token punctuation">.</span>color<span class="token punctuation">.</span>colorOut
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">menuColor</span><span class="token punctuation">(</span><span class="token parameter">colorover<span class="token punctuation">,</span> colorout</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colorOver <span class="token operator">=</span> colorover
  <span class="token keyword">this</span><span class="token punctuation">.</span>colorOut <span class="token operator">=</span> colorout
<span class="token punctuation">}</span>

<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> word<span class="token operator">:</span> <span class="token string">'menu1'</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'black'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> word<span class="token operator">:</span> <span class="token string">'menu2'</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'green'</span><span class="token punctuation">,</span> <span class="token string">'black'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> word<span class="token operator">:</span> <span class="token string">'menu3'</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">,</span> <span class="token string">'black'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">menuItem</span><span class="token punctuation">(</span>
    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>word<span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">menuColor</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>color<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>color<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>Express 中创建 get 等方法</p> <p>需求：express 中 get，post 等方法，有七八个，如何快速地创建。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">,</span> <span class="token string">'put'</span><span class="token punctuation">]</span>
methods<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">[</span>method<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//利用桥接过来的route来完成post，get等请求</span>
    route<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>route<span class="token punctuation">,</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="享元模式的示例"><a href="#享元模式的示例" class="header-anchor">#</a> 🍅 享元模式的示例</h4> <p>文件上传</p> <p>需求：项目中有一个文件上传功能，该功能可以上传多个文件</p> <p>一般做法</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//文件上传</span>
<span class="token keyword">function</span> <span class="token function">uploader</span><span class="token punctuation">(</span><span class="token parameter">fileType<span class="token punctuation">,</span> file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fileType <span class="token operator">=</span> fileType
  <span class="token keyword">this</span><span class="token punctuation">.</span>file <span class="token operator">=</span> file
<span class="token punctuation">}</span>
uploader<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//初始化文件上传的html</span>
<span class="token punctuation">}</span>
uploader<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">delete</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//删除掉该html</span>
<span class="token punctuation">}</span>
uploader<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">uploading</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//上传</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">uploader</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> fileob1<span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">uploader</span><span class="token punctuation">(</span><span class="token string">'txt'</span><span class="token punctuation">,</span> fileob2<span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">uploader</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">,</span> fileob3<span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">uploader</span><span class="token punctuation">(</span><span class="token string">'word'</span><span class="token punctuation">,</span> fileob4<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>享元模式</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//fileType,file</span>
<span class="token keyword">function</span> <span class="token function">uploader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
uploader<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//初始化文件上传的html</span>
<span class="token punctuation">}</span>
uploader<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">delete</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//删除掉该html</span>
<span class="token punctuation">}</span>
uploader<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">uploading</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">filetype<span class="token punctuation">,</span> file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> fileob1<span class="token punctuation">,</span> fileob2<span class="token punctuation">,</span> fileob3<span class="token punctuation">,</span> fileob4
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'img'</span><span class="token punctuation">,</span>
    file<span class="token operator">:</span> fileob1
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'txt'</span><span class="token punctuation">,</span>
    file<span class="token operator">:</span> fileob2
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'img'</span><span class="token punctuation">,</span>
    file<span class="token operator">:</span> fileob3
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'word'</span><span class="token punctuation">,</span>
    file<span class="token operator">:</span> fileob4
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">var</span> uploader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">uploader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  uploader<span class="token punctuation">.</span><span class="token function">uploading</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>file<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>jQuery 的 extend</p> <p>需求：extends 方法，需要判断参数数量来进行不同的操作</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 一般做法</span>
<span class="token keyword">var</span> jQuery <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
jQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
jQuery<span class="token punctuation">.</span>extend <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">extend</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 享元做法，保留一个公共的for循环</span>
jQuery<span class="token punctuation">.</span>extend <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">extend</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> target <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">var</span> source
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target <span class="token operator">=</span> <span class="token keyword">this</span>
    source <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    source <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> source<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> target
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h4 id="模版方法模式的示例"><a href="#模版方法模式的示例" class="header-anchor">#</a> 🍅 模版方法模式的示例</h4> <p>编写一个弹窗组件</p> <p>需求：项目有一系列弹窗，每个弹窗的行为、大小、文字不同</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">basePop</span><span class="token punctuation">(</span><span class="token parameter">word<span class="token punctuation">,</span> size</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>word <span class="token operator">=</span> word
  <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">=</span> size
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
basePop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>word
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token string">'px'</span>
  div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>height <span class="token operator">+</span> <span class="token string">'px'</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> div
<span class="token punctuation">}</span>
basePop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hidden</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//定义基础操作</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
<span class="token punctuation">}</span>
basePop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">confirm</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//定义基础操作</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">ajaxPop</span><span class="token punctuation">(</span><span class="token parameter">word<span class="token punctuation">,</span> size</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">basePop</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> word<span class="token punctuation">,</span> size<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ajaxPop<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">basePop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> hidden <span class="token operator">=</span> ajaxPop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hidden
ajaxPop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">hidden</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">hidden</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> confirm <span class="token operator">=</span> ajaxPop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>confirm
ajaxPop<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">confirm</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">confirm</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> pop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ajaxPop</span><span class="token punctuation">(</span><span class="token string">'sendmes'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> height<span class="token operator">:</span> <span class="token number">300</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
pop<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
pop<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> axios <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>上面这个就是我们面向对象中的继承，模版模式不一定非要通过继承方式来完成，它强调先定义后面进行不同维度的操作的基本行为；</p> <p>然后在这个基本行为上有扩展的空间，这就是我们模版方法的目的。</p> <p>封装一个算法计算器</p> <p>需求：现在我们有一系列自己的算法，但是这个算法常在不同的地方需要增加一些不同的操作</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//算法计算器</span>

<span class="token keyword">function</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>beforeCounter <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>afterCounter <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">//然后我们把具体的不同部分留到具体使用的时候去扩展</span>
<span class="token comment">//所以我们定义两个方法来扩展</span>
counter<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addBefore</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>beforeCounter<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
counter<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addAfter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>afterCounter<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//最终计算方法</span>
counter<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">count</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//结果变量</span>
  <span class="token keyword">var</span> _resultnum <span class="token operator">=</span> num
  <span class="token comment">//算法队列数组组装</span>
  <span class="token keyword">var</span> _arr <span class="token operator">=</span> <span class="token punctuation">[</span>baseCount<span class="token punctuation">]</span>
  _arr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>beforeCounter<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>_arr<span class="token punctuation">)</span>
  _arr <span class="token operator">=</span> _arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>afterCounter<span class="token punctuation">)</span>
  <span class="token comment">//不同部分的相同算法骨架</span>
  <span class="token keyword">function</span> <span class="token function">baseCount</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    num <span class="token operator">+=</span> <span class="token number">4</span>
    num <span class="token operator">*=</span> <span class="token number">2</span>
    <span class="token keyword">return</span> num
  <span class="token punctuation">}</span>
  <span class="token comment">//循环执行算法队列</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>_arr<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _resultnum <span class="token operator">=</span> _arr<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_resultnum<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> _resultnum
<span class="token punctuation">}</span>
<span class="token comment">//使用</span>
<span class="token keyword">var</span> countObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
countObject<span class="token punctuation">.</span><span class="token function">addBefore</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  num<span class="token operator">--</span>
  <span class="token keyword">return</span> num
<span class="token punctuation">}</span><span class="token punctuation">)</span>
countObject<span class="token punctuation">.</span><span class="token function">addAfter</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  num <span class="token operator">*=</span> <span class="token number">2</span>
  <span class="token keyword">return</span> num
<span class="token punctuation">}</span><span class="token punctuation">)</span>
countObject<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>这个应用了组合实现模版模式</p> <p><font color="red"><strong>javascript 的组合与继承</strong></font></p> <ul><li><p>组合（推荐）</p> <ol><li>javascript 最初没有专门的继承，所以最初 javascript 推崇函数式的编程，然后进行统一组合桥接到一起</li> <li>桥接模式可以看出组合的一种体现，组合的好处是耦合低，方便方法复用，方便扩展</li></ol></li> <li><p>继承</p> <ol><li>es6 出现 class 与 extend，继承的方式多种多样，但是都是各有弊端</li> <li>模版方法模式可以看出继承的一种体现，继承的好处是可以自动获得父类的内容与接口，方便统一化</li></ol></li></ul> <h3 id="_4-3-4-总结"><a href="#_4-3-4-总结" class="header-anchor">#</a> 4.3.4 总结</h3> <ul><li>桥接模式</li></ul> <p>通过独立方法间接的桥接来形成整体功能，这样每个方法都可以被高度复用</p> <ul><li>享元模式</li></ul> <p>提取出公有部分与私有部分，私有部分作为外部数据传入，从而减少对象数量</p> <ul><li>模版方法模式</li></ul> <p>当一个功能朝着多样化发展，不妨先定义一个基础的，把具体实现延迟到后面</p> <h2 id="_4-4-提高可扩展性-1"><a href="#_4-4-提高可扩展性-1" class="header-anchor">#</a> 4.4 提高可扩展性（1）</h2> <p>提高可扩展性的目的</p> <ul><li>面对需求变更，方便更该需求</li> <li>减少代码修改的难度</li></ul> <p>什么是好的扩展</p> <ul><li>需求的变更，不需要重写</li> <li>代码修改不会引起大规模变动</li> <li>方便加入新模块</li></ul> <h3 id="_4-4-1-提高可扩展性的设计模式"><a href="#_4-4-1-提高可扩展性的设计模式" class="header-anchor">#</a> 4.4.1 提高可扩展性的设计模式</h3> <h4 id="更好的更改代码"><a href="#更好的更改代码" class="header-anchor">#</a> 🍅 更好的更改代码</h4> <ul><li>适配器模式（接口）</li></ul> <p>适配器模式的目的：通过写一个适配器，来代替替换</p> <p>适配器模式的应用场景：面临接口不通用的问题</p> <ul><li>装饰者模式（方法作用）</li></ul> <p>装饰者模式的目的：不重写方法的扩展方法</p> <p>装饰者模式的应用场景：放一个方法需要扩展，但是又不好去修改方法</p> <h4 id="解耦你得方法与调用"><a href="#解耦你得方法与调用" class="header-anchor">#</a> 🍅 解耦你得方法与调用</h4> <ul><li>命令模式</li></ul> <p>命令模式的目的：解耦实现和调用，让双方互不干扰</p> <p>命令模式的应用场景：调用的命令充满不确性</p> <h3 id="_4-4-2-基本结构"><a href="#_4-4-2-基本结构" class="header-anchor">#</a> 4.4.2 基本结构</h3> <h4 id="适配器模式的基本结构"><a href="#适配器模式的基本结构" class="header-anchor">#</a> 🍅 适配器模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">log</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> winodw<span class="token punctuation">.</span>console<span class="token punctuation">.</span>log
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>想用 log 来代替 console.log</p> <h4 id="装饰者模式的基本结构"><a href="#装饰者模式的基本结构" class="header-anchor">#</a> 🍅 装饰者模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 在一个他人写好的模版a内部调用b，模块为他人写好，不能修改，如何扩展b方法？</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">b</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">myb</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 要扩展的方法</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我们新建一个自己的方法，在其内部调用 b 方法，并且再执行自己的方法，这样可以在不修改原方法的情况下扩展方法</p> <h4 id="命令模式的基本结构"><a href="#命令模式的基本结构" class="header-anchor">#</a> 🍅 命令模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">var</span> command<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">// action中定义了各种方法</span>
      <span class="token keyword">var</span> action<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token comment">// excure可以调用action方法</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">excure</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// command只需输入命令就可以调用action里的方法</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_4-4-3-应用示例"><a href="#_4-4-3-应用示例" class="header-anchor">#</a> 4.4.3 应用示例</h3> <h4 id="适配器模式示例"><a href="#适配器模式示例" class="header-anchor">#</a> 🍅 适配器模式示例</h4> <p>框架的变更</p> <p>需求：目前项目使用的 A 框架，现在改成了 B，2 个框架与十分类似，但是有少数几个方法不同</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// A框架调用的方式</span>
<span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 假如我们项目中换成了jQuey，我们不想全部去替换A方法，就用适配器的方法</span>
<span class="token constant">A</span><span class="token punctuation">.</span><span class="token function-variable function">c</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> $<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>参数适配</p> <p>需求：为了避免参数不适配产生问题，很多框架会有一个参数适配操作</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 给参数适配，没传值给默认值</span>
<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _defalut <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    color<span class="token operator">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> _defalut<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _defalut<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> config<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">||</span> _defalut<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> _defalut
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="装饰者模式示例"><a href="#装饰者模式示例" class="header-anchor">#</a> 🍅 装饰者模式示例</h4> <p>扩展你的已有事件绑定</p> <p>需求：现在项目改造，需要给 input 标签已经有的事件增加一些操作</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">decorator</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> dom<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _old <span class="token operator">=</span> dom<span class="token punctuation">.</span>onclick
    dom<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">_old</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">decorator</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'dom1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 自己的操作</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Vue 的数组监听</p> <p>需求：vue 中利用 defineProperty 可以监听对象，那么数组怎么办</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> arrayProto <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype
<span class="token keyword">var</span> arrayMethods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayProto<span class="token punctuation">)</span>
<span class="token keyword">var</span> methodsToPatch <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'push'</span><span class="token punctuation">,</span>
  <span class="token string">'pop'</span><span class="token punctuation">,</span>
  <span class="token string">'unshift'</span><span class="token punctuation">,</span>
  <span class="token string">'shift'</span><span class="token punctuation">,</span>
  <span class="token string">'splice'</span><span class="token punctuation">,</span>
  <span class="token string">'resverse'</span><span class="token punctuation">,</span>
  <span class="token string">'sort'</span>
<span class="token punctuation">]</span>

methodsToPatch<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">method</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> original <span class="token operator">=</span> arrayMethods<span class="token punctuation">[</span>method<span class="token punctuation">]</span>
  object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>arrayMethods<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">value</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">original</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
      dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>装饰者模式，拿到老方法，调用老方法，组成新方法</p> <h4 id="命令模式示例"><a href="#命令模式示例" class="header-anchor">#</a> 🍅 命令模式示例</h4> <p>需求：封装一系列的 canvas 绘图命令</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> <span class="token function-variable function">myCanvas</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
myCanvas<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">drawCircle</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
myCanvas<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">drawRect</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> canvasComand <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> action <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">drawCircle</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">drawRect</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">excute</span><span class="token punctuation">(</span><span class="token parameter">commander</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    commander<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      action<span class="token punctuation">[</span>item<span class="token punctuation">.</span>command<span class="token punctuation">]</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>config<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">myCanvas</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> command<span class="token operator">:</span> <span class="token string">'drawReact'</span><span class="token punctuation">,</span> config<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol><li><p>用户只管输入他要的命令，不用关心 api</p></li> <li><p>命令和实现解耦，无论命令发生变动，还是实现发生变动，都不会彼此影响</p></li></ol> <p>绘制随数量图片</p> <p>需求：需要做一个画廊，图片数量和排列顺序随机</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> createImg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> action <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">create</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> htmlArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">var</span> _htmlstring <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token keyword">var</span> _htmlTemplate <span class="token operator">=</span>
        <span class="token string">&quot;&lt;div&gt;&lt;img src='{{img-url}}' /&gt;&lt;/div&gt;&lt;h2&gt;{{title}}&lt;/h2&gt;&quot;</span>
      <span class="token keyword">var</span> displayWay <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">normal</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> arr
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">reverse</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> arr<span class="token punctuation">.</span>reverse
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      obj<span class="token punctuation">.</span>imgArr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">img</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> _html
        _html <span class="token operator">=</span> _htmlTemplate
          <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'{{img-url}}'</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>img<span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'{{title}}'</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
        htmlArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_html<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      htmlArr <span class="token operator">=</span> displayWay<span class="token punctuation">[</span>obj<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>htmlArr<span class="token punctuation">)</span>
      _htmlstring <span class="token operator">=</span> htmlArr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token string">'&lt;div&gt;'</span> <span class="token operator">+</span> _htmlstring <span class="token operator">+</span> <span class="token string">'&lt;/div&gt;'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">display</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> _html <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
      obj<span class="token punctuation">.</span>target<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _html
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">excute</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _default <span class="token operator">=</span> <span class="token punctuation">{</span>
      imgArr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> img<span class="token operator">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'default title'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      type<span class="token operator">:</span> <span class="token string">'normal'</span><span class="token punctuation">,</span>
      target<span class="token operator">:</span> document<span class="token punctuation">.</span>body
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> _default<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _default<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">||</span> _default<span class="token punctuation">[</span>item<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    action<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span>_default<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">createImg</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  imgArr<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> img<span class="token operator">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'default title1'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> img<span class="token operator">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'default title2'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  type<span class="token operator">:</span> <span class="token string">'normal'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p>数据-&gt; excute 命令解析层 -&gt; 调用 api</p> <h3 id="_4-4-4-总结"><a href="#_4-4-4-总结" class="header-anchor">#</a> 4.4.4 总结</h3> <ul><li>适配器模式</li></ul> <p>当面临两个新老模块间接口 api 不匹配，可以用适配来转化 api</p> <ul><li>装饰者模式</li></ul> <p>当老的方法，不方便去直接修改，可以通装饰者来增加功能</p> <ul><li>命令模式</li></ul> <p>解耦实现与具体命令，让实现端和命令端扩展的都更轻松</p> <h2 id="_4-5-提高可扩展性-2"><a href="#_4-5-提高可扩展性-2" class="header-anchor">#</a> 4.5 提高可扩展性（2）</h2> <p>提高整体项目可扩展性的核心</p> <ul><li><p>低耦合</p></li> <li><p>良好的组织沟通方式</p></li></ul> <h3 id="_4-5-1-提高可扩展性的设计模式"><a href="#_4-5-1-提高可扩展性的设计模式" class="header-anchor">#</a> 4.5.1 提高可扩展性的设计模式</h3> <h4 id="应对需求上的变更"><a href="#应对需求上的变更" class="header-anchor">#</a> 🍅 应对需求上的变更</h4> <ul><li>观察者模式（事件绑定是典型的观察者模式，比如 dom 上监视点击了事件，点击事件触发以后就去做这个点击事件）</li></ul> <p>观察者模式的目的：减少对象间的耦合，来提高可扩展性</p> <p>观察者模式的应用场景：当两个模块直接沟通会增加它们的耦合性时</p> <ul><li>职责链模式</li></ul> <p>职责链模式的目的：为了避免请求发送者与多个请求处理者耦合在一起，形成一个链条</p> <p>组合模式的应用场景：把操作分隔成一系列模块，每个模块只处理自己的事情</p> <h4 id="应对需求上的变更-2"><a href="#应对需求上的变更-2" class="header-anchor">#</a> 🍅 应对需求上的变更</h4> <p>访问者模式的目的：解耦数据结构与数据操作</p> <p>访问者模式的应用场景：数据结构不希望与操作有关联</p> <h3 id="_4-5-2-基本结构"><a href="#_4-5-2-基本结构" class="header-anchor">#</a> 4.5.2 基本结构</h3> <h4 id="观察者的基本结构"><a href="#观察者的基本结构" class="header-anchor">#</a> 🍅 观察者的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> observe <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">regist</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token operator">=</span>fn
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fire</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">remove</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>定义一个中转观察者，两个模块之间不直接沟通，而是通过观察者，一般使用与不方便直接沟通，或者异步操作</li></ul> <h4 id="职责链模式的基本结构"><a href="#职责链模式的基本结构" class="header-anchor">#</a> 🍅 职责链模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">mode1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mode2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mode3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

_result <span class="token operator">=</span> <span class="token function">mode1</span><span class="token punctuation">(</span>_result<span class="token punctuation">)</span>
_result <span class="token operator">=</span> <span class="token function">mode2</span><span class="token punctuation">(</span>_result<span class="token punctuation">)</span>
_result <span class="token operator">=</span> <span class="token function">mode3</span><span class="token punctuation">(</span>_result<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>把要做的事情组织为一条有序的链条，通过再这条链条传递消息来完成功能，适用于不设计到赋值异步操作</li></ul> <h4 id="访问者模式的基本结构"><a href="#访问者模式的基本结构" class="header-anchor">#</a> 🍅 访问者模式的基本结构</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">var</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

handler<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">vistor</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">handler<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  handler<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>通过定义一个访问者，代替直接访问对象，来减少两个对象之间的耦合</li></ul> <h3 id="_4-5-3-应用示例"><a href="#_4-5-3-应用示例" class="header-anchor">#</a> 4.5.3 应用示例</h3> <h4 id="观察者模式示例"><a href="#观察者模式示例" class="header-anchor">#</a> 🍅 观察者模式示例</h4> <p>多人合作的问题</p> <p>需求：现在假设 A 工程师写了首页模块，然后 B 工程师写了评论模块。现在要把评论展示在首页</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> observe <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">regist</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token operator">=</span>fn
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fire</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">comment</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> self<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>commentList<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      type<span class="token operator">:</span><span class="token string">'hot'</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span><span class="token string">'xxxx'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 注册事件</span>
observeOb<span class="token punctuation">.</span><span class="token function">regist</span><span class="token punctuation">(</span><span class="token string">'gotHot'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> _arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>commentList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>type<span class="token operator">===</span><span class="token string">'hot'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      _arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> _arr
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
<span class="token comment">// 调用事件</span>
<span class="token keyword">var</span> _arr<span class="token operator">=</span>observeOb<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'gotHot'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>一个转盘</p> <p>需求：有一个转盘应用，每转一圈，速度加快</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> observe <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">regist</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token operator">=</span>fn
<span class="token punctuation">}</span>

observe<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">fire</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> observeOb<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">observe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 初始化html=&gt; 最终结果选定 =&gt; 运动结果 =&gt; 运动控制</span>

<span class="token keyword">var</span> _domArr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">function</span> <span class="token function">htmlInit</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">9</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> _div<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
    _div<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span>i
    _div<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span><span class="token string">'item'</span><span class="token punctuation">)</span>
    target<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>_div<span class="token punctuation">)</span>
    _domArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_div<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getFinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> _num<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token number">40</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>_num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 运动模块</span>
<span class="token keyword">function</span> <span class="token function">mover</span> <span class="token punctuation">(</span><span class="token parameter">moveConfig</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> nowIn<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> removeNum<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> timer<span class="token operator">=</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nowIn<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      removeNum<span class="token operator">=</span>nowIn<span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
    _domArr<span class="token punctuation">[</span>removeNum<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span><span class="token string">'item'</span><span class="token punctuation">)</span>
    _domArr<span class="token punctuation">[</span>nowIn<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'class'</span><span class="token punctuation">,</span><span class="token string">'item item-on'</span><span class="token punctuation">)</span>
    nowIn<span class="token operator">++</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nowIn<span class="token operator">==</span>moveConfig<span class="token punctuation">.</span>moveTime<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>moveConfig<span class="token punctuation">.</span>moveTime<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        observeOb<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'finish'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>moveConfig<span class="token punctuation">.</span>speed<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">moveControll</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> final<span class="token operator">=</span><span class="token function">getFinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> _circle<span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>final<span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> stopNum<span class="token operator">=</span>final<span class="token operator">%</span><span class="token number">10</span>
  <span class="token keyword">var</span> _speed<span class="token operator">=</span><span class="token number">2000</span>
  <span class="token keyword">var</span> _runCircle<span class="token operator">=</span><span class="token number">0</span>
  <span class="token function">mover</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    moveTime<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>
    speed<span class="token operator">:</span>_speed
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  observeOb<span class="token punctuation">.</span><span class="token function">regist</span><span class="token punctuation">(</span><span class="token string">'finish'</span><span class="token punctuation">,</span><span class="token function">fucntion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> _time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    _speed<span class="token operator">-=</span><span class="token number">50</span><span class="token punctuation">;</span>
    _runCircle<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>_runCircle<span class="token operator">&lt;=</span>_circle<span class="token punctuation">)</span><span class="token punctuation">{</span>
      _time<span class="token operator">=</span><span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
      _time<span class="token operator">=</span>stopNum
    <span class="token punctuation">}</span>
    <span class="token function">mover</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      moveTime<span class="token operator">:</span>_time<span class="token punctuation">,</span>
      speed<span class="token operator">:</span>_speed
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">htmlInit</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">moveControll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br></div></div><h4 id="职责链模式示例"><a href="#职责链模式示例" class="header-anchor">#</a> 🍅 职责链模式示例</h4> <p>Axios 的拦截器</p> <p>需求：axios 拦截器的设计，大家可以看成一个用给职责链的思想去处理请求</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>interceptors <span class="token operator">=</span> <span class="token punctuation">{</span>
    request<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">interceptorsManner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    response<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">interceptorsManner</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  axios<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">request</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> chain <span class="token operator">=</span> <span class="token punctuation">[</span>dispathReuest<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">]</span>
    <span class="token keyword">var</span> promise <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">interceptor</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      chain<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>interceptor<span class="token punctuation">.</span>fulfilled<span class="token punctuation">,</span> interceptor<span class="token punctuation">.</span>injected<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">interceptor</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      chain<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span>interceptor<span class="token punctuation">.</span>fulfilled<span class="token punctuation">,</span> interceptor<span class="token punctuation">.</span>injected<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>chain<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      promise <span class="token operator">=</span> promise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>chain<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> chain<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">interceptorsManner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>handlers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

interceptorsManner<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">use</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fulfilled<span class="token punctuation">,</span> rejected</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>handlers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    fulfilled<span class="token operator">:</span> fulfilled<span class="token punctuation">,</span>
    rejected<span class="token operator">:</span> rejected
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>利用职责链组织一个表单验证</p> <p>需求：有一个表单，需要前后台校验，后台校验</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 表单事件绑定-&gt;表单前端验证-&gt;表单后端验证</span>
<span class="token comment">// 思想：把你要做的事情拆分为模块，模块之间只做自己模块的事情</span>

input<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _value <span class="token operator">=</span> input<span class="token punctuation">.</span>value
  <span class="token keyword">var</span> _arr <span class="token operator">=</span> <span class="token punctuation">[</span>font<span class="token punctuation">,</span> middle<span class="token punctuation">,</span> back<span class="token punctuation">,</span> fontAgain<span class="token punctuation">]</span>
  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _result <span class="token operator">=</span> _value
    <span class="token keyword">while</span> <span class="token punctuation">(</span>_arr<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _result <span class="token operator">=</span> <span class="token keyword">await</span> _arr<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _result
  <span class="token punctuation">}</span>
  <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">font</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">middle</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fontAgain</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="访问者模式示例"><a href="#访问者模式示例" class="header-anchor">#</a> 🍅 访问者模式示例</h4> <p>不同角色访问数据</p> <p>需求：假设有一个公司的财务报表，财务关心支出和收入，老板关心盈利</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>income <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>cost <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>profit <span class="token operator">=</span> <span class="token string">''</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">boss</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

boss<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">account</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

account<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">vistor</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> man</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> handle <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">boss</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      man<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>profit<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">account</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      man<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>income<span class="token punctuation">,</span> data<span class="token punctuation">.</span>cost<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  handle<span class="token punctuation">[</span>man<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">vistor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">account</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">vistor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">boss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 设计的数据结构操作难以去访问具体的数据结构的时候</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>表格操作</p> <p>需求：一个可以新增，删除的表格</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">table</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

  table<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">show</span><span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>

  table<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">delete</span><span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">vistor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableData<span class="token punctuation">,</span><span class="token string">'delete'</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  table<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span><span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> tableData<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span><span class="token string">'xxx'</span><span class="token punctuation">,</span>
      prize<span class="token operator">:</span><span class="token string">'xxx'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>

  <span class="token keyword">function</span> <span class="token function">vistor</span> <span class="token punctuation">(</span><span class="token parameter">table<span class="token punctuation">,</span>data<span class="token punctuation">,</span>handle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> handleOb<span class="token operator">=</span><span class="token punctuation">{</span>
      <span class="token function-variable function">delete</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      add<span class="token operator">:</span><span class="token function">funtion</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>price</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> arg<span class="token operator">=</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    arg<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    handleOb<span class="token punctuation">[</span>handle<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apple</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arg<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="_4-5-4-总结"><a href="#_4-5-4-总结" class="header-anchor">#</a> 4.5.4 总结</h3> <ul><li>观察者模式</li></ul> <p>适用于不适合直接沟通的模块之间的组织</p> <ul><li>职责链模式</li></ul> <p>组织同步模块，把要做的事情划分为模块，要做的事情一次传递</p> <ul><li>访问者模式</li></ul> <p>解耦数据操作与数据结构</p> <h2 id="_4-6-提高代码质量"><a href="#_4-6-提高代码质量" class="header-anchor">#</a> 4.6 提高代码质量</h2> <p>提高代码质量</p> <ul><li>高质量的代码，方便后续的一切操作</li> <li>方便他人阅读</li></ul> <p>什么是代码质量</p> <ol><li>代码整洁</li> <li>结构规整，没有漫长的结构</li> <li>阅读好理解</li></ol> <h3 id="_4-6-1-优化代码结构"><a href="#_4-6-1-优化代码结构" class="header-anchor">#</a> 4.6.1 优化代码结构</h3> <ul><li>策略模式/状态模式</li></ul> <p>策略/状态模式的目的：优化 if-else 分支</p> <p>策略/状态模式的应用场景：当代码 if-else 分支过多时</p> <ul><li>外观模式</li></ul> <p>外观模式的目的：通过为多个复杂的子系统提供一个一致的接口</p> <p>外观模式的应用场景：当完成一个操作时，需要操作多个子系统，不如提供一个更高级的</p> <h3 id="_4-6-2-优化你的代码操作"><a href="#_4-6-2-优化你的代码操作" class="header-anchor">#</a> 4.6.2 优化你的代码操作</h3> <ul><li>迭代器模式</li></ul> <p>迭代器者模式的目的：不访问内部的情况下，方便的遍历数据</p> <p>迭代器模式的应用场景：当我们需要对某个对象进行操作，但是又不能暴露内部</p> <ul><li>备忘录模式</li></ul> <p>备忘录模式的目的：记录状态，方便回滚</p> <p>备忘录模式的应用场景：系统状态多样，为了保证状态的回滚方便，记录状态</p> <h3 id="_4-6-3-基本结构"><a href="#_4-6-3-基本结构" class="header-anchor">#</a> 4.6.3 基本结构</h3> <h4 id="策略模式的基本结构"><a href="#策略模式的基本结构" class="header-anchor">#</a> 🍅 策略模式的基本结构</h4> <p>假设要编写一个计算器，有加减乘除，我们把一层一层的 if 判断，变成下面的形式</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token keyword">function</span> <span class="token function">Strategy</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> Strategyer<span class="token operator">=</span><span class="token punctuation">{</span>
      <span class="token function-variable function">add</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token operator">+</span>b
      <span class="token punctuation">}</span>
      <span class="token function-variable function">minus</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token operator">-</span>b
      <span class="token punctuation">}</span>
      <span class="token function-variable function">division</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token operator">/</span>b
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Strategyer<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="状态模式的基本结构-加了状态的策略模式"><a href="#状态模式的基本结构-加了状态的策略模式" class="header-anchor">#</a> 🍅 状态模式的基本结构（加了状态的策略模式）</h4> <p>为了减少 if-else 结构，将判断变成对象内部的一个状态，通过对象内部的状态改变，让其拥有不同的行为</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">stateFactor</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> stateObject <span class="token operator">=</span> <span class="token punctuation">{</span>
    _status<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    state<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">state1</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">state2</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">run</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>_status<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  stateObject<span class="token punctuation">.</span>_status <span class="token operator">=</span> state
  <span class="token keyword">return</span> stateObject
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="外观模式的基本结构"><a href="#外观模式的基本结构" class="header-anchor">#</a> 🍅 外观模式的基本结构</h4> <p>我们组织方法模块时可以细化多个接口，但是我们给别人使用时，要合为一个接口就像你可以直接去餐厅去点套餐</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 模块1</span>
<span class="token keyword">function</span> <span class="token function">Model1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 模块2</span>
<span class="token keyword">function</span> <span class="token function">Model2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 功能由Model1获取Model2得结果来完成</span>

<span class="token keyword">function</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Model2</span><span class="token punctuation">(</span><span class="token function">Model1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="迭代器模式的基本结构"><a href="#迭代器模式的基本结构" class="header-anchor">#</a> 🍅 迭代器模式的基本结构</h4> <p>在不暴露对象内部结构的同时，可以顺序的访问对象内部，可以帮助我们简化循环，简化数据操作</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Iterator</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>item <span class="token operator">=</span> item
<span class="token punctuation">}</span>
<span class="token class-name">Iterator</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">dealEach</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="备忘录模式的基本结构"><a href="#备忘录模式的基本结构" class="header-anchor">#</a> 🍅 备忘录模式的基本结构</h4> <p>记录对象内部的状态，当有需要时回滚到之前的状态或者方便对象使用</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Memento</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cacheName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>cacheName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 有缓存的操作</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 没有缓存的操作</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> MementtoFn <span class="token operator">=</span> <span class="token function">Memento</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">MementtoFn</span><span class="token punctuation">(</span><span class="token string">'xxxcx'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_4-6-4-应用示例"><a href="#_4-6-4-应用示例" class="header-anchor">#</a> 4.6.4 应用示例</h3> <h4 id="策略-状态模式的示例"><a href="#策略-状态模式的示例" class="header-anchor">#</a> 🍅 策略/状态模式的示例</h4> <p>动态的内容</p> <p>需求：项目有一个动态的内容，根据用户权限的不同显示不同的内容</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 没有用策略的模式的情况</span>
<span class="token keyword">function</span> <span class="token function">showPart1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">showPart2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">showPart3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token string">'boss'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showPart1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">showPart2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">showPart3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token string">'manner'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showPart1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">showPart2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token string">'staff'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showPart3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 用策略模式的情况</span>
<span class="token keyword">function</span> <span class="token function">showControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>power <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">boss</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">showPart1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">showPart2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">showPart3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">manner</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">showPart1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">showPart2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">staff</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">showPart3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
showControl<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">show</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
  axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">.</span>status <span class="token operator">=</span> res
    self<span class="token punctuation">.</span>power<span class="token punctuation">[</span>self<span class="token punctuation">.</span>status<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">showControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>复合运动</p> <p>需求：有一个小球，可以控制它左右移动，或则左前，右前等方式移动</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">moveLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'left'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">moveRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'RigmoveRight'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">moveTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Top'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">moveBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bomoveBottom'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 没有用状态模式的情况</span>
<span class="token keyword">function</span> <span class="token function">mover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'left'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'right'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'top'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'bottom'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'left'</span> <span class="token operator">&amp;&amp;</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'top'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">moveTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'right'</span> <span class="token operator">&amp;&amp;</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'bottom'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">moveBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 用状态模式的情况</span>
<span class="token keyword">function</span> <span class="token function">mover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>actionHandle <span class="token operator">=</span> <span class="token punctuation">{</span>
    left<span class="token operator">:</span> moveLeft<span class="token punctuation">,</span>
    right<span class="token operator">:</span> moveRight<span class="token punctuation">,</span>
    top<span class="token operator">:</span> moveTop<span class="token punctuation">,</span>
    bottom<span class="token operator">:</span> moveBottom
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
mover<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>actionHandle<span class="token punctuation">[</span>action<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">mover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'left'</span><span class="token punctuation">,</span> <span class="token string">'right'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h4 id="外观模式的示例"><a href="#外观模式的示例" class="header-anchor">#</a> 🍅 外观模式的示例</h4> <p>插件封装的规律</p> <p>需求：插件基本都会给最终使用提供一个高级接口</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 划分功能，给使用者一个统一的接口</span>
<span class="token keyword">function</span> <span class="token function">tab</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
tab<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">initHTML</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
tab<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">changeTab</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
tab<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eventBind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">.</span><span class="token function">changeTab</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
tab<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initHTML</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">eventBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>封装成方法的思想</p> <p>需求：在兼容时代，我们会常常需要检测能力，不妨作为一个统一接口</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//dom支持检测</span>
<span class="token keyword">function</span> <span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token parameter">dom<span class="token punctuation">,</span> type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>dom<span class="token punctuation">.</span>addEventListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dom<span class="token punctuation">.</span>attachEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    dom<span class="token punctuation">[</span><span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">]</span> <span class="token operator">=</span> fn
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="迭代器模式的示例"><a href="#迭代器模式的示例" class="header-anchor">#</a> 🍅 迭代器模式的示例</h4> <p>构建一个自己的 forEach</p> <p>需求：forEach 方法其实是一个典型的迭代器方法</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 对数组和对象进行迭代</span>
<span class="token comment">//forEach</span>
<span class="token keyword">function</span> <span class="token function">Iterator</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data
<span class="token punctuation">}</span>
<span class="token class-name">Iterator</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">dealEach</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>给你的项目数据添加迭代器</p> <p>需求：项目经常对于后端数据进行遍历操作，不如封装一个迭代器，遍历的更方便</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//数据迭代器</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> num<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> num<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> num<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token keyword">function</span> <span class="token function">i</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">Iterator</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data
  <span class="token punctuation">}</span>
  <span class="token class-name">Iterator</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getHasSomenum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">handler<span class="token punctuation">,</span> num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">var</span> handleFn
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> handler <span class="token operator">==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      handleFn <span class="token operator">=</span> handler
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">handleFn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">[</span>handler<span class="token punctuation">]</span> <span class="token operator">==</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> item
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> _result <span class="token operator">=</span> <span class="token function">handleFn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>_result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_result<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _arr
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Iterator</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">i</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHasSomenum</span><span class="token punctuation">(</span><span class="token string">'num'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// 自定义的筛选方法</span>
<span class="token function">i</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHasSomenum</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>num <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> item
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h4 id="备忘录模式的示例"><a href="#备忘录模式的示例" class="header-anchor">#</a> 🍅 备忘录模式的示例</h4> <p>文章页的缓存</p> <p>需求：项目有一个文章页需求，现在进行优化，如果上一篇已经读取过了，则不进行请求，否则请求文章数据</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//缓存</span>
<span class="token keyword">function</span> <span class="token function">pager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">pageName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> cache<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>pageName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        cache<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span> <span class="token operator">=</span> res
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> getpage <span class="token operator">=</span> <span class="token function">pager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">getpage</span><span class="token punctuation">(</span><span class="token string">'pageone'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>前进后退功能</p> <p>需求：开发一个可移动的 div，拥有前进后退功能能回滚到之前的位置</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//前进后退</span>
<span class="token keyword">function</span> <span class="token function">moveDiv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>stateList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 缓存之前的状态</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nowState <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 状态指针，指向当前状态在哪个</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * @param {string} type 往哪个方向移动
 * @param {Number} num  移动多远
 */</span>
moveDiv<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">move</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">changeDiv</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> num<span class="token punctuation">)</span> <span class="token comment">//假设移动位置的函数</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>stateList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> type<span class="token punctuation">,</span>
    num<span class="token operator">:</span> num
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 添加状态</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>nowState <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stateList<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token comment">// 设置当前指针</span>
<span class="token punctuation">}</span>
moveDiv<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">go</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//前进</span>
  <span class="token keyword">var</span> _state
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowState <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stateList<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//当前指针小于数组最后一位，说明能前进</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>nowState<span class="token operator">++</span>
    _state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stateList<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowState<span class="token punctuation">]</span>
    <span class="token function">changeDiv</span><span class="token punctuation">(</span>_state<span class="token punctuation">.</span>type<span class="token punctuation">,</span> _state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
moveDiv<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">back</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//后退</span>
  <span class="token keyword">var</span> _state
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowState <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>nowState<span class="token operator">--</span>
    _state <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stateList<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>nowState<span class="token punctuation">]</span>
    <span class="token function">changeDiv</span><span class="token punctuation">(</span>_state<span class="token punctuation">.</span>type<span class="token punctuation">,</span> _state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="_4-6-5-本章总结"><a href="#_4-6-5-本章总结" class="header-anchor">#</a> 4.6.5 本章总结</h3> <ul><li>策略/状态模式</li></ul> <p>帮助我们优化 if-else 结构</p> <ul><li>外观模式</li></ul> <p>一种套餐化接口的思想，提醒我们封装常用方法</p> <ul><li>迭代器模式</li></ul> <p>帮助我们更好的遍历数据</p> <ul><li>备忘录模式</li></ul> <p>帮我们缓存以及回到过去的状态</p> <h2 id="_4-7-总结"><a href="#_4-7-总结" class="header-anchor">#</a> 4.7 总结</h2> <div class="custom-block warning"><p class="custom-block-title">提示</p> <p>我们的设计模式，要记住其思想，不用记住其结构，结构不是固定；我们通过设计模式主要是提高我们代码的质量</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/13/2025, 7:45:34 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/jsadvanced/asyncpro.html" class="prev">异步编程</a></span> <span class="next"><a href="/computerNetwork/protocal.html">网络协议</a>
      →
    </span></p></div> </main> <footer class="footer" data-v-266a5a28><div class="container" data-v-266a5a28><p class="text-center" data-v-266a5a28>© 2024 web全栈体系. All Rights Reserved.（所有文章未经授权禁止转载、摘编、复制或建立镜像，如有违反，追究法律责任。）</p> <p class="text-center" data-v-266a5a28><a href="https://beian.miit.gov.cn" target="_blank" data-v-266a5a28>豫ICP备19041317号-1</a></p></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0f616eb6.js" defer></script><script src="/assets/js/3.9750fba5.js" defer></script><script src="/assets/js/2.6aa46093.js" defer></script><script src="/assets/js/97.c2372908.js" defer></script>
  </body>
</html>
